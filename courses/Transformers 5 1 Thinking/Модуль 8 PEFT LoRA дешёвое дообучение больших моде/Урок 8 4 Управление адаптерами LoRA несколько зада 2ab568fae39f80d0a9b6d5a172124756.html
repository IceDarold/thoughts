<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>–£—Ä–æ–∫ 8.4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏ LoRA: –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á, merge, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2ab568fa-e39f-80d0-a9b6-d5a172124756" class="page sans"><header><h1 class="page-title">–£—Ä–æ–∫ 8.4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏ LoRA: –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á, merge, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞</h1><p class="page-description"></p></header><div class="page-body"><p id="2ab568fa-e39f-80db-a7b9-d2b66611fd73" class="">–ù—É —á—Ç–æ, —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –±–æ—Å—Å –º–æ–¥—É–ª—è 8 ‚Äî <strong>–∂–∏–∑–Ω—å —Å –∑–æ–æ–ø–∞—Ä–∫–æ–º –∞–¥–∞–ø—Ç–µ—Ä–æ–≤</strong> üß¨</p><p id="2ab568fa-e39f-80a0-a32b-ef10af2a5d8f" class="">–í 8.2 –∏ 8.3 —Ç—ã –Ω–∞—É—á–∏–ª—Å—è –¥–µ–ª–∞—Ç—å LoRA –¥–ª—è –±–æ—Ç–∞ –∏ —Å—É–º–º–∞—Ä–∏–∑–∞—Ç–æ—Ä–∞.</p><p id="2ab568fa-e39f-809d-97ab-c9faf8e5ba26" class="">–¢–µ–ø–µ—Ä—å –∑–∞–¥–∞—á–∞: <strong>–Ω–∞—É—á–∏—Ç—å—Å—è –∏–º–∏ —É–ø—Ä–∞–≤–ª—è—Ç—å</strong> ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤, merge, –∞–∫–∫—É—Ä–∞—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞.</p><hr id="2ab568fa-e39f-80b9-891a-f27f11eb75d8"/><h2 id="2ab568fa-e39f-80a4-baa2-e49dac7d10e8" class="">0. –ß—Ç–æ –¥–µ–ª–∞–µ–º –≤ —ç—Ç–æ–º —É—Ä–æ–∫–µ</h2><p id="2ab568fa-e39f-8009-b009-c0d42e1723c1" class="">–ü–ª–∞–Ω —É—Ä–æ–∫–∞:</p><ol type="1" id="2ab568fa-e39f-80a6-ba2b-c837e22bff3a" class="numbered-list" start="1"><li>–û—Å–æ–∑–Ω–∞—ë–º, —á—Ç–æ —Ç–∞–∫–æ–µ ‚Äú–±–∞–∑–∞ + –∞–¥–∞–ø—Ç–µ—Ä—ã‚Äù –∫–∞–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞.</li></ol><ol type="1" id="2ab568fa-e39f-802d-b328-d75739d06a6c" class="numbered-list" start="2"><li>–î–µ–ª–∞–µ–º <strong>—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞</strong>: base-–º–æ–¥–µ–ª–∏, adapters, merged.</li></ol><ol type="1" id="2ab568fa-e39f-8040-ba32-e95a463cdc39" class="numbered-list" start="3"><li>–£—á–∏–º—Å—è:<ul id="2ab568fa-e39f-801b-8573-cb2cd08fc207" class="bulleted-list"><li style="list-style-type:disc">–≥—Ä—É–∑–∏—Ç—å –±–∞–∑—É –∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å <strong>—Ä–∞–∑–Ω—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã –ø–æ–¥ –∑–∞–¥–∞—á–∏</strong> (–±–æ—Ç A, –±–æ—Ç B, —Å—É–º–º–∞—Ä–∏–∑–∞—Ç–æ—Ä),</li></ul><ul id="2ab568fa-e39f-80bc-b575-e4459543f391" class="bulleted-list"><li style="list-style-type:disc"><strong>–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è</strong> –º–µ–∂–¥—É –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏ –Ω–∞ –ª–µ—Ç—É,</li></ul><ul id="2ab568fa-e39f-80b7-9cd7-e685bbb395f8" class="bulleted-list"><li style="list-style-type:disc"><strong>merge-and-unload</strong>: —Å–ª–∏–≤–∞—Ç—å LoRA –≤ –±–∞–∑–æ–≤—É—é –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –¥–µ–ø–ª–æ—è.</li></ul></li></ol><ol type="1" id="2ab568fa-e39f-80eb-8d5e-c9e438f845c0" class="numbered-list" start="4"><li>–°–æ–±–∏—Ä–∞–µ–º –Ω–µ–±–æ–ª—å—à–æ–π ‚Äú—Ä–æ—É—Ç–µ—Ä‚Äù –∑–∞–¥–∞—á: –æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ —Ñ–ª–∞–≥—É <code>-task=...</code> –≤—ã–±–∏—Ä–∞–µ—Ç –Ω—É–∂–Ω—ã–π –∞–¥–∞–ø—Ç–µ—Ä –∏ –¥–µ–ª–∞–µ—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å.</li></ol><p id="2ab568fa-e39f-807b-b43d-d6a9dcc40be7" class="">–í –∫–æ–Ω—Ü–µ ‚Äî –¥–æ–º–∞—à–∫–∞: —Å–¥–µ–ª–∞—Ç—å –¥–≤–∞ –∞–¥–∞–ø—Ç–µ—Ä–∞ –∏ —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–µ–∂–¥—É –Ω–∏–º–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è.</p><hr id="2ab568fa-e39f-80cd-a895-d0223984f55f"/><h2 id="2ab568fa-e39f-8088-8879-d84443585184" class="">1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚Äú–±–∞–∑–∞ + –∞–¥–∞–ø—Ç–µ—Ä—ã‚Äù</h2><p id="2ab568fa-e39f-80e8-b4cd-dccaba00fbe8" class="">–ò–¥–µ—è:</p><ul id="2ab568fa-e39f-80e0-ad6f-dfd5f6399933" class="bulleted-list"><li style="list-style-type:disc">–£ —Ç–µ–±—è –µ—Å—Ç—å <strong>–æ–¥–Ω–∞ –±–æ–ª—å—à–∞—è –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å</strong> (–Ω–∞–ø—Ä–∏–º–µ—Ä, LLaMA 7B –∏–ª–∏ BART large).</li></ul><ul id="2ab568fa-e39f-8096-af41-f5e1df13c0ea" class="bulleted-list"><li style="list-style-type:disc">–ò –º–Ω–æ–≥–æ –∑–∞–¥–∞—á:<ul id="2ab568fa-e39f-80af-88d2-fea64b7ba96d" class="bulleted-list"><li style="list-style-type:circle">—Å–∞–ø–ø–æ—Ä—Ç-–±–æ—Ç –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è A,</li></ul><ul id="2ab568fa-e39f-80f0-922c-e1d863c60199" class="bulleted-list"><li style="list-style-type:circle">—Å–∞–ø–ø–æ—Ä—Ç-–±–æ—Ç –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è B,</li></ul><ul id="2ab568fa-e39f-8030-955f-c153705e1760" class="bulleted-list"><li style="list-style-type:circle">—Å—É–º–º–∞—Ä–∏–∑–∞—Ç–æ—Ä –¥–∏–∞–ª–æ–≥–æ–≤ —Å–∞–ø–ø–æ—Ä—Ç–∞,</li></ul><ul id="2ab568fa-e39f-8023-85f4-f40fe8263efe" class="bulleted-list"><li style="list-style-type:circle">–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∏–∫–µ—Ç–æ–≤ –∏ —Ç.–¥.</li></ul></li></ul><p id="2ab568fa-e39f-8057-9a8f-d791455081a0" class="">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å:</p><ul id="2ab568fa-e39f-802e-be48-dd4415e07732" class="bulleted-list"><li style="list-style-type:disc">–ü–æ–¥ –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É –¥–µ–ª–∞—Ç—å <strong>–ø–æ–ª–Ω—ã–π fine-tuning</strong> ‚Üí –∫—É—á–∞ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤ –Ω–∞ –¥–µ—Å—è—Ç–∫–∏ –ì–ë –∫–∞–∂–¥—ã–π.</li></ul><p id="2ab568fa-e39f-80bd-8006-c10e8a9a10c0" class="">PEFT-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:</p><ul id="2ab568fa-e39f-80b9-b273-dfbbc05eca50" class="bulleted-list"><li style="list-style-type:disc">–æ–¥–Ω–∞ –±–∞–∑–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, <code>base/llama-7b</code>),</li></ul><ul id="2ab568fa-e39f-80b6-80ea-c6ebc10e3832" class="bulleted-list"><li style="list-style-type:disc">–º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–∞–ª–µ–Ω—å–∫–∏—Ö LoRA-–∞–¥–∞–ø—Ç–µ—Ä–æ–≤:<ul id="2ab568fa-e39f-8099-b828-e6de9e05ea22" class="bulleted-list"><li style="list-style-type:circle"><code>support_appA_lora</code>,</li></ul><ul id="2ab568fa-e39f-80fc-841f-d5ebd62cc0a6" class="bulleted-list"><li style="list-style-type:circle"><code>support_appB_lora</code>,</li></ul><ul id="2ab568fa-e39f-801b-a18c-fbcd1ca169e7" class="bulleted-list"><li style="list-style-type:circle"><code>dialogs_summarizer_lora</code>.</li></ul></li></ul><p id="2ab568fa-e39f-8028-a076-d4b68016bae2" class="">–û—Ç—Å—é–¥–∞ –ø–ª—é—Å—ã:</p><ul id="2ab568fa-e39f-800a-bcd2-ef9cee4f6a80" class="bulleted-list"><li style="list-style-type:disc"><strong>–ü–∞–º—è—Ç—å/–¥–∏—Å–∫</strong>: –æ–¥–Ω–∞ –±–æ–ª—å—à–∞—è –º–æ–¥–µ–ª—å + –∫—É—á–∞ –º–µ–ª–∫–∏—Ö –¥–æ–ø-–≤–µ—Å–æ–≤.</li></ul><ul id="2ab568fa-e39f-80cb-af13-c0b1be080949" class="bulleted-list"><li style="list-style-type:disc"><strong>–ì–∏–±–∫–æ—Å—Ç—å</strong>: –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ.</li></ul><ul id="2ab568fa-e39f-80ec-8533-eee423fe398f" class="bulleted-list"><li style="list-style-type:disc"><strong>–û–±–Ω–æ–≤–ª—è–µ–º–æ—Å—Ç—å</strong>: –ø–µ—Ä–µ–æ–±—É—á–∞–µ—à—å —Ç–æ–ª—å–∫–æ –∞–¥–∞–ø—Ç–µ—Ä, –±–∞–∑—É –Ω–µ —Ç—Ä–æ–≥–∞–µ—à—å.</li></ul><hr id="2ab568fa-e39f-809b-9408-c7c9250cf182"/><h2 id="2ab568fa-e39f-80a7-9e7a-ee0725c7e715" class="">2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞</h2><p id="2ab568fa-e39f-8033-8b2b-e2635d2ecc45" class="">–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80af-86d4-e60af3e7554a" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">project_root/
  models/
    base/
      gpt2/                        # –ø—Ä–∏–º–µ—Ä –º–µ–ª–∫–æ–π –∫–∞—É–∑–∞–ª–∫–∏
      facebook_bart_large_cnn/     # –±–∞–∑–æ–≤—ã–π BART
      # –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ –º–æ–¥–µ–ª–∏ —Å Hub

    adapters/
      support_appA_lora/           # LoRA-–±–æ—Ç –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è A
      support_appB_lora/           # LoRA-–±–æ—Ç –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è B
      dialog_summarizer_lora/      # LoRA-—Å—É–º–º–∞—Ä–∏–∑–∞—Ç–æ—Ä

    merged/
      support_appA_merged/         # –±–∞–∑–∞ + LoRA —Å–ª–∏—Ç—ã
      dialog_summarizer_merged/

  configs/
    adapters_config.json           # –∫–∞—Ä—Ç–∞ –∑–∞–¥–∞—á -&gt; (base_model, adapter_path)

  src/
    inference_router.py
    train_lora_causal.py
    train_lora_summarizer.py
</code></pre><p id="2ab568fa-e39f-80e8-8ac0-e9e8bd968b48" class="">–≠—Ç–æ –Ω–µ —Å–≤—è—â–µ–Ω–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç, –Ω–æ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–µ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ —Å–≤–∞–ª–∫—É.</p><hr id="2ab568fa-e39f-80b0-8e8e-cd84c0271c6a"/><h2 id="2ab568fa-e39f-8013-9242-c790ba711994" class="">3. –ö–æ–Ω—Ñ–∏–≥ –¥–ª—è –∞–¥–∞–ø—Ç–µ—Ä–æ–≤: <code>adapters_config.json</code></h2><p id="2ab568fa-e39f-80e8-911a-ee48f17acd51" class="">–°–¥–µ–ª–∞–µ–º –æ–¥–∏–Ω –∫–æ–Ω—Ñ–∏–≥, –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç:</p><ul id="2ab568fa-e39f-8093-8ff7-ef3b3b5c9a6b" class="bulleted-list"><li style="list-style-type:disc">–∫–∞–∫—É—é –±–∞–∑–æ–≤—É—é –º–æ–¥–µ–ª—å –±—Ä–∞—Ç—å,</li></ul><ul id="2ab568fa-e39f-8033-ae38-dc7dcc4b02c9" class="bulleted-list"><li style="list-style-type:disc">–≥–¥–µ –ª–µ–∂–∏—Ç –∞–¥–∞–ø—Ç–µ—Ä,</li></ul><ul id="2ab568fa-e39f-805e-830c-d86d72b4f058" class="bulleted-list"><li style="list-style-type:disc">—á—Ç–æ –∑–∞ —Ç–∏–ø –∑–∞–¥–∞—á–∏ (–¥–ª—è –Ω–∞—Å —Å–∫–æ—Ä–µ–µ –º–µ—Ç–∞-–∏–Ω—Ñ–æ).</li></ul><p id="2ab568fa-e39f-8093-a836-f4dbef7022e2" class="">–ü—Ä–∏–º–µ—Ä:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8091-85f5-de839b458250" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">{
  &quot;support_appA&quot;: {
    &quot;task_type&quot;: &quot;causal_lm&quot;,
    &quot;base_model&quot;: &quot;gpt2&quot;,
    &quot;adapter_path&quot;: &quot;models/adapters/support_appA_lora&quot;
  },
  &quot;support_appB&quot;: {
    &quot;task_type&quot;: &quot;causal_lm&quot;,
    &quot;base_model&quot;: &quot;gpt2&quot;,
    &quot;adapter_path&quot;: &quot;models/adapters/support_appB_lora&quot;
  },
  &quot;dialog_summarizer&quot;: {
    &quot;task_type&quot;: &quot;seq2seq_lm&quot;,
    &quot;base_model&quot;: &quot;facebook/bart-large-cnn&quot;,
    &quot;adapter_path&quot;: &quot;models/adapters/dialog_summarizer_lora&quot;
  }
}
</code></pre><p id="2ab568fa-e39f-8073-bcc2-fe71359b0f98" class="">–ó–∞—á–µ–º:</p><ul id="2ab568fa-e39f-80de-99c2-f9264b14f930" class="bulleted-list"><li style="list-style-type:disc">–º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∞–¥–∞–ø—Ç–µ—Ä ‚Üí –ø—Ä–æ—Å—Ç–æ –¥–æ–ø–∏—Å–∞–ª —Ä–∞–∑–¥–µ–ª –≤ json.</li></ul><ul id="2ab568fa-e39f-80c2-8c4d-f9d85afa9d73" class="bulleted-list"><li style="list-style-type:disc">–∫–æ–¥ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º:<ul id="2ab568fa-e39f-805b-9ff2-d10f1b97b1b6" class="bulleted-list"><li style="list-style-type:circle">–≤—ã–±–∏—Ä–∞–µ–º –∑–∞–¥–∞—á—É –ø–æ –∫–ª—é—á—É,</li></ul><ul id="2ab568fa-e39f-805f-9f56-da59b065999c" class="bulleted-list"><li style="list-style-type:circle">–æ—Å—Ç–∞–ª—å–Ω–æ–µ –±–µ—Ä—ë–º –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞.</li></ul></li></ul><hr id="2ab568fa-e39f-804e-901c-ca9f81d1ec32"/><h2 id="2ab568fa-e39f-808d-a882-d52028ddf01d" class="">4. –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –∏ –∞–¥–∞–ø—Ç–µ—Ä–∞ –ø–æ –∫–æ–Ω—Ñ–∏–≥—É</h2><p id="2ab568fa-e39f-80c3-af4b-ef6b82ee9d42" class="">–°–¥–µ–ª–∞–µ–º –º–æ–¥—É–ª—å <code>src/inference_router.py</code>, –∫–æ—Ç–æ—Ä—ã–π:</p><ul id="2ab568fa-e39f-801f-94fd-c3579832bf4f" class="bulleted-list"><li style="list-style-type:disc">—á–∏—Ç–∞–µ—Ç <code>adapters_config.json</code>,</li></ul><ul id="2ab568fa-e39f-80fc-9064-c16594a9948c" class="bulleted-list"><li style="list-style-type:disc">–ø–æ –∏–º–µ–Ω–∏ –∑–∞–¥–∞—á–∏ (<code>task_name</code>) –∑–∞–≥—Ä—É–∂–∞–µ—Ç:<ul id="2ab568fa-e39f-80ad-b050-c0e149e9a20e" class="bulleted-list"><li style="list-style-type:circle">–Ω—É–∂–Ω—ã–π <code>AutoModel*</code>,</li></ul><ul id="2ab568fa-e39f-804a-b516-e701b5129c50" class="bulleted-list"><li style="list-style-type:circle">—Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä,</li></ul><ul id="2ab568fa-e39f-800d-bd0c-def7c190a0a5" class="bulleted-list"><li style="list-style-type:circle">LoRA-–∞–¥–∞–ø—Ç–µ—Ä.</li></ul></li></ul><h3 id="2ab568fa-e39f-80d9-be0e-dea5cab06caf" class="">4.1. –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-808a-a893-c89043cd71d8" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">import json
from pathlib import Path

CONFIG_PATH = Path(&quot;configs/adapters_config.json&quot;)

with open(CONFIG_PATH, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f:
    ADAPTERS_CONFIG = json.load(f)
</code></pre><h3 id="2ab568fa-e39f-80e8-88c0-e2340d5dc2d8" class="">4.2. –Æ—Ç–∏–ª–∫–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∑–∞–ø–∏—Å–∏</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80f1-ace1-d3ef88db899a" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">def get_task_config(task_name: str):
    if task_name not in ADAPTERS_CONFIG:
        raise ValueError(f&quot;Unknown task_name=&#x27;{task_name}&#x27;. Available: {list(ADAPTERS_CONFIG.keys())}&quot;)
    return ADAPTERS_CONFIG[task_name]
</code></pre><hr id="2ab568fa-e39f-80b0-af3c-fb16d0964ecc"/><h2 id="2ab568fa-e39f-8098-bf35-c4b13a466632" class="">5. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ + –∞–¥–∞–ø—Ç–µ—Ä–∞</h2><p id="2ab568fa-e39f-8072-9a3b-df5e535b5edc" class="">–°–¥–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è:</p><ul id="2ab568fa-e39f-8029-82b6-c67312e4a33d" class="bulleted-list"><li style="list-style-type:disc">–ø–æ <code>task_name</code>:<ul id="2ab568fa-e39f-80e3-9fb1-f4bc2c62b316" class="bulleted-list"><li style="list-style-type:circle">–ø–æ–Ω–∏–º–∞–µ—Ç, <code>task_type</code> (<code>causal_lm</code> –∏–ª–∏ <code>seq2seq_lm</code>),</li></ul><ul id="2ab568fa-e39f-80cb-83ec-ea2b7d257070" class="bulleted-list"><li style="list-style-type:circle">–≥—Ä—É–∑–∏—Ç –Ω—É–∂–Ω—ã–π –∫–ª–∞—Å—Å –∏–∑ <code>transformers</code>,</li></ul><ul id="2ab568fa-e39f-808d-afc0-e07e5854f288" class="bulleted-list"><li style="list-style-type:circle">–Ω–∞–≤–µ—à–∏–≤–∞–µ—Ç LoRA —á–µ—Ä–µ–∑ <code>PeftModel.from_pretrained</code>.</li></ul></li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-805d-aa74-c30fbb0434d6" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">import torch
from transformers import (
    AutoTokenizer,
    AutoModelForCausalLM,
    AutoModelForSeq2SeqLM,
)
from peft import PeftModel

device = torch.device(&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;)
</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80fc-a0e9-e0d74fcaaa40" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">def load_model_with_adapter(task_name: str):
    cfg = get_task_config(task_name)
    task_type = cfg[&quot;task_type&quot;]
    base_model_name = cfg[&quot;base_model&quot;]
    adapter_path = cfg[&quot;adapter_path&quot;]

    print(f&quot;[load_model_with_adapter] Task={task_name}, base={base_model_name}, adapter={adapter_path}&quot;)

    tokenizer = AutoTokenizer.from_pretrained(base_model_name)

    if task_type == &quot;causal_lm&quot;:
        base_model = AutoModelForCausalLM.from_pretrained(
            base_model_name,
            torch_dtype=torch.float16 if torch.cuda.is_available() else torch.float32,
        ).to(device)
    elif task_type == &quot;seq2seq_lm&quot;:
        base_model = AutoModelForSeq2SeqLM.from_pretrained(
            base_model_name,
            torch_dtype=torch.float16 if torch.cuda.is_available() else torch.float32,
        ).to(device)
    else:
        raise ValueError(f&quot;Unsupported task_type=&#x27;{task_type}&#x27;&quot;)

    # –ù–∞–≤–µ—à–∏–≤–∞–µ–º LoRA-–∞–¥–∞–ø—Ç–µ—Ä
    model = PeftModel.from_pretrained(
        base_model,
        adapter_path,
    )
    model.eval()

    # –ü–∞–¥-—Ç–æ–∫–µ–Ω –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
    if tokenizer.pad_token is None:
        tokenizer.pad_token = tokenizer.eos_token if tokenizer.eos_token is not None else tokenizer.unk_token

    return model, tokenizer, task_type
</code></pre><p id="2ab568fa-e39f-80c9-a45d-ed0ed5926845" class="">–¢–µ–ø–µ—Ä—å –æ–¥–Ω–∏–º –≤—ã–∑–æ–≤–æ–º:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-801f-a95b-f7b731cbcc2e" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">model, tokenizer, task_type = load_model_with_adapter(&quot;support_appA&quot;)
</code></pre><p id="2ab568fa-e39f-8059-8083-d66a4081198b" class="">—Ç—ã –ø–æ–ª—É—á–∏—à—å –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –ø–æ –Ω—É–∂–Ω–æ–π –∑–∞–¥–∞—á–µ.</p><hr id="2ab568fa-e39f-80c3-8dfe-eca738e25b93"/><h2 id="2ab568fa-e39f-80b0-8567-d3a55cf3ffa4" class="">6. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏ (—á—É—Ç—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ)</h2><p id="2ab568fa-e39f-80bb-8725-c16c879550d1" class="">–ï—Å—Ç—å –¥–≤–∞ —Å—Ç–∏–ª—è:</p><h3 id="2ab568fa-e39f-807e-a0d6-debe51f132de" class="">6.1. –ü—Ä–æ—Å—Ç–æ–π (–∏ —á–∞—â–µ <em>–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π</em>): –æ—Ç–¥–µ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –Ω–∞ –∫–∞–∂–¥—ã–π –∞–¥–∞–ø—Ç–µ—Ä</h3><ul id="2ab568fa-e39f-8055-808b-c67d0658ed32" class="bulleted-list"><li style="list-style-type:disc">–ë–∞–∑–æ–≤—É—é –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞ / –∑–∞–¥–∞—á–∏.</li></ul><ul id="2ab568fa-e39f-805e-b642-ea1dea50e3d8" class="bulleted-list"><li style="list-style-type:disc">–≠—Ç–æ –ø—Ä–æ—â–µ –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ, –∑–∞—Ç–æ –ø–∞–º—è—Ç—å/—Å–∫–æ—Ä–æ—Å—Ç—å —Å—Ç—Ä–∞–¥–∞—é—Ç, –µ—Å–ª–∏ –¥–µ—Ä–∂–∞—Ç—å –∏—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.</li></ul><p id="2ab568fa-e39f-8069-b8b1-d37c5b8c8f73" class="">–ü—Ä–∏–º–µ—Ä:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8009-94db-f28853351a9a" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">model_appA, tok_appA, _ = load_model_with_adapter(&quot;support_appA&quot;)
model_appB, tok_appB, _ = load_model_with_adapter(&quot;support_appB&quot;)
</code></pre><p id="2ab568fa-e39f-802c-87e8-c7bc1f1dc849" class="">–î–∞–ª—å—à–µ:</p><ul id="2ab568fa-e39f-8086-9968-df0dc77adb90" class="bulleted-list"><li style="list-style-type:disc"><code>model_appA.generate(...)</code> ‚Äî –ø–æ–≤–µ–¥–µ–Ω–∏–µ A,</li></ul><ul id="2ab568fa-e39f-8098-9406-e2dd2db8882f" class="bulleted-list"><li style="list-style-type:disc"><code>model_appB.generate(...)</code> ‚Äî –ø–æ–≤–µ–¥–µ–Ω–∏–µ B.</li></ul><p id="2ab568fa-e39f-806c-8129-de64d84087bf" class="">–≠—Ç–æ —É–∂–µ –Ω–æ—Ä–º –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.</p><h3 id="2ab568fa-e39f-80aa-a479-d69392e48aeb" class="">6.2. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π: –æ–¥–∏–Ω base + –Ω–µ—Å–∫–æ–ª—å–∫–æ adapters –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ PeftModel</h3><p id="2ab568fa-e39f-804f-8d6f-d1f405f198af" class="">–ï—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–æ –Ω–∞ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –∞–¥–∞–ø—Ç–µ—Ä—ã, –º–æ–∂–Ω–æ:</p><ol type="1" id="2ab568fa-e39f-8065-9773-ccdf2e8485e6" class="numbered-list" start="1"><li>–í–∑—è—Ç—å –æ–¥–Ω—É –±–∞–∑–æ–≤—É—é –º–æ–¥–µ–ª—å.</li></ol><ol type="1" id="2ab568fa-e39f-8024-8dca-c048a6b1cd87" class="numbered-list" start="2"><li>–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ –Ω–µ—ë <strong>–Ω–µ—Å–∫–æ–ª—å–∫–æ</strong> –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏.</li></ol><ol type="1" id="2ab568fa-e39f-8005-a70b-fd177dfb4346" class="numbered-list" start="3"><li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <code>model.set_adapter(&quot;–∏–º—è&quot;)</code>, —á—Ç–æ–±—ã –≤—ã–±–∏—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π.</li></ol><p id="2ab568fa-e39f-8062-a533-db5cff9bc9b4" class="">–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ (API –º–æ–∂–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ <code>peft</code>, –Ω–æ –∏–¥–µ—è —Ç–∞–∫–∞—è):</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80af-9550-f3d4832fd1e5" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">from peft import PeftModel, LoraConfig, get_peft_model

base_model_name = &quot;gpt2&quot;
base_model = AutoModelForCausalLM.from_pretrained(
    base_model_name,
    torch_dtype=torch.float16 if torch.cuda.is_available() else torch.float32,
).to(device)

# –°–Ω–∞—á–∞–ª–∞ –¥–µ–ª–∞–µ–º PeftModel —Å –∫–∞–∫–∏–º-—Ç–æ –±–∞–∑–æ–≤—ã–º –∫–æ–Ω—Ñ–∏–≥–æ–º (–º–æ–∂–µ—Ç –±—ã—Ç—å &quot;–ø—É—Å—Ç–æ–π&quot; –∏–ª–∏ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞)
# –î–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å –æ–¥–∏–Ω –∞–¥–∞–ø—Ç–µ—Ä –Ω–∞ –¥–∏—Å–∫–µ, –º—ã –µ–≥–æ –∑–∞–≥—Ä—É–∑–∏–º –∫–∞–∫ &quot;–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é&quot;:

model = PeftModel.from_pretrained(
    base_model,
    &quot;models/adapters/support_appA_lora&quot;,
    adapter_name=&quot;support_appA&quot;,
)

# –ó–∞–≥—Ä—É–∂–∞–µ–º –µ—â—ë –æ–¥–∏–Ω –∞–¥–∞–ø—Ç–µ—Ä –≤ —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç:
model.load_adapter(
    &quot;models/adapters/support_appB_lora&quot;,
    adapter_name=&quot;support_appB&quot;,
)

# –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è:
model.set_adapter(&quot;support_appA&quot;)
# ... –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è A

model.set_adapter(&quot;support_appB&quot;)
# ... –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è B
</code></pre><p id="2ab568fa-e39f-802b-a8e4-f929a72d6e1e" class="">–≠—Ç–æ —Ç–æ–Ω—å—à–µ –∏ –ø–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞:</p><ul id="2ab568fa-e39f-8052-a1d7-edb5ac890dfa" class="bulleted-list"><li style="list-style-type:disc">—É —Ç–µ–±—è –º–∞–ª–æ –ø–∞–º—è—Ç–∏,</li></ul><ul id="2ab568fa-e39f-80e1-a37b-ee866ae449fb" class="bulleted-list"><li style="list-style-type:disc">—Ç—ã —Ö–æ—á–µ—à—å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É –∏ —Ç—É –∂–µ base+peft ‚Äú–æ–±—ë—Ä—Ç–∫—É‚Äù,</li></ul><ul id="2ab568fa-e39f-8091-bfca-e4a9603cfab6" class="bulleted-list"><li style="list-style-type:disc">—á–∞—Å—Ç–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—à—å—Å—è –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏.</li></ul><p id="2ab568fa-e39f-8026-a7c9-fa6460da324f" class="">–î–ª—è –∫—É—Ä—Å–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ <strong>–∑–Ω–∞—Ç—å</strong>, —á—Ç–æ —Ç–∞–∫ –º–æ–∂–Ω–æ; –≤ –ø—Ä–∞–∫—Ç–∏–∫–µ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Ö–æ–¥ (–æ—Ç–¥–µ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –ø–æ–¥ –∑–∞–¥–∞—á—É).</p><hr id="2ab568fa-e39f-8005-a860-cc9a922e2d9c"/><h2 id="2ab568fa-e39f-804b-8456-e86036442de7" class="">7. Merge LoRA –≤ –±–∞–∑–æ–≤—É—é –º–æ–¥–µ–ª—å (–¥–ª—è –¥–µ–ø–ª–æ—è)</h2><p id="2ab568fa-e39f-8041-8ea3-e343dc54329c" class="">–ò–Ω–æ–≥–¥–∞ –≤ –ø—Ä–æ–¥–µ –Ω–µ —Ö–æ—á–µ—Ç—Å—è —Ç–∞—â–∏—Ç—å:</p><ul id="2ab568fa-e39f-8004-b0e2-f21ce16fe1ba" class="bulleted-list"><li style="list-style-type:disc"><code>peft</code>,</li></ul><ul id="2ab568fa-e39f-80ac-9d29-ddedc2082d68" class="bulleted-list"><li style="list-style-type:disc">–æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–∞–ø–∫–∏ —Å –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏,</li></ul><ul id="2ab568fa-e39f-8089-b70a-e0cd5a205a4b" class="bulleted-list"><li style="list-style-type:disc">—Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É ‚Äúbase + adapter‚Äù.</li></ul><p id="2ab568fa-e39f-805d-a547-fd3cd876cc3c" class="">–ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:</p><blockquote id="2ab568fa-e39f-806e-b763-c436c9556488" class="">‚Äú–°–ª–∏—Ç—å LoRA-–≤–µ—Å–∞ –≤ –±–∞–∑–æ–≤—É—é –º–æ–¥–µ–ª—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–¥–∏–Ω –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π —á–µ–∫–ø–æ–∏–Ω—Ç‚Äù.</blockquote><h3 id="2ab568fa-e39f-80f0-9690-d9aa36bedfe0" class="">7.1. –ö–∞–∫ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80c9-9515-c287de3d22af" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">from peft import PeftModel
from transformers import AutoModelForCausalLM, AutoTokenizer

base_model_name = &quot;gpt2&quot;
adapter_path = &quot;models/adapters/support_appA_lora&quot;

# 1. –ì—Ä—É–∑–∏–º –±–∞–∑—É
base_model = AutoModelForCausalLM.from_pretrained(
    base_model_name,
    torch_dtype=torch.float16 if torch.cuda.is_available() else torch.float32,
)

# 2. –ù–∞–≤–µ—à–∏–≤–∞–µ–º LoRA
peft_model = PeftModel.from_pretrained(base_model, adapter_path)

# 3. –ú—ë—Ä–¥–∂–∏–º LoRA –≤ –≤–µ—Å–∞ –∏ ‚Äú–æ—Ç–∫–ª–µ–∏–≤–∞–µ–º‚Äù PEFT-–æ–±—ë—Ä—Ç–∫—É
merged_model = peft_model.merge_and_unload()

# 4. –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ –æ–±—ã—á–Ω—É—é –º–æ–¥–µ–ª—å
save_dir = &quot;models/merged/support_appA_merged&quot;
merged_model.save_pretrained(save_dir)

tokenizer = AutoTokenizer.from_pretrained(base_model_name)
tokenizer.save_pretrained(save_dir)
</code></pre><p id="2ab568fa-e39f-80a6-be02-c24b4b58f462" class="">–¢–µ–ø–µ—Ä—å:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80aa-8ec4-f7657b6f0172" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">from transformers import AutoModelForCausalLM, AutoTokenizer

merged_model = AutoModelForCausalLM.from_pretrained(
    &quot;models/merged/support_appA_merged&quot;,
    torch_dtype=torch.float16 if torch.cuda.is_available() else torch.float32,
).to(device)

tokenizer = AutoTokenizer.from_pretrained(&quot;models/merged/support_appA_merged&quot;)
</code></pre><p id="2ab568fa-e39f-8079-aa17-c5da9d06b327" class="">–ò –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <code>merged_model.generate(...)</code> <strong>–±–µ–∑ PeftModel –∏ adapter_path</strong>.</p><h3 id="2ab568fa-e39f-80d5-87ed-e7f7157829e7" class="">7.2. –ü–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã merge</h3><p id="2ab568fa-e39f-80cf-b035-f46b9f12cfb7" class=""><strong>–ü–ª—é—Å—ã:</strong></p><ul id="2ab568fa-e39f-80e4-ad59-c9f7d50ebf4a" class="bulleted-list"><li style="list-style-type:disc">–ø—Ä–æ—â–µ –¥–µ–ø–ª–æ–∏—Ç—å (–∫–∞–∫ –æ–±—ã—á–Ω—É—é –º–æ–¥–µ–ª—å),</li></ul><ul id="2ab568fa-e39f-8035-ac33-c03d980093d9" class="bulleted-list"><li style="list-style-type:disc">–Ω–µ –Ω—É–∂–µ–Ω <code>peft</code>,</li></ul><ul id="2ab568fa-e39f-80b6-b5b5-c7b286c1ac62" class="bulleted-list"><li style="list-style-type:disc">–º–µ–Ω—å—à–µ –º–∞–≥–∏–∏, –µ—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –≤ —Ç–µ–º–µ LoRA.</li></ul><p id="2ab568fa-e39f-8043-a9e5-cb000b820e3a" class=""><strong>–ú–∏–Ω—É—Å—ã:</strong></p><ul id="2ab568fa-e39f-8000-a447-f7156e97985f" class="bulleted-list"><li style="list-style-type:disc">—á–µ–∫–ø–æ–∏–Ω—Ç –ø–æ —Ä–∞–∑–º–µ—Ä—É ‚âà –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å (–≤–µ—Å–∞ LoRA ‚Äú–≤–ª–∏—Ç—ã–µ‚Äù –≤ –Ω–µ—ë),</li></ul><ul id="2ab568fa-e39f-8067-bbdb-c20dfb0c0927" class="bulleted-list"><li style="list-style-type:disc">–Ω–µ–ª—å–∑—è –±—ã—Å—Ç—Ä–æ ‚Äú–æ—Ç–∫—Ä—É—Ç–∏—Ç—å‚Äù LoRA –∏–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥–æ–π –∞–¥–∞–ø—Ç–µ—Ä,</li></ul><ul id="2ab568fa-e39f-80d1-be30-e74699a29e51" class="bulleted-list"><li style="list-style-type:disc">–ø–æ–¥ –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É –Ω—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π merged-—á–µ–∫–ø–æ–∏–Ω—Ç ‚Üí –ø–æ –¥–∏—Å–∫—É —Ç–æ –∂–µ, —á—Ç–æ –∏ full FT-–ø–æ–¥—Ö–æ–¥ (–Ω–æ –æ–±—É—á–µ–Ω–∏–µ –≤—Å—ë —Ä–∞–≤–Ω–æ –±—ã–ª–æ PEFT-–¥–µ—à—ë–≤—ã–º).</li></ul><hr id="2ab568fa-e39f-8008-9e06-efd4541f63ea"/><h2 id="2ab568fa-e39f-806e-a38a-def5a9362681" class="">8. –ù–µ–±–æ–ª—å—à–æ–π ‚Äú—Ä–æ—É—Ç–µ—Ä‚Äù –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞: –æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç ‚Äî –º–Ω–æ–≥–æ –∑–∞–¥–∞—á</h2><p id="2ab568fa-e39f-80a2-bd17-d60dfc0b25fe" class="">–°–æ–±–µ—Ä—ë–º –≤—Å—ë –≤–º–µ—Å—Ç–µ: –Ω–∞–ø–∏—à–µ–º CLI-—Å–∫—Ä–∏–ø—Ç <code>inference_router.py</code>, –∫–æ—Ç–æ—Ä—ã–π:</p><ul id="2ab568fa-e39f-8077-a3ea-c8490386f12c" class="bulleted-list"><li style="list-style-type:disc">–ø—Ä–∏–Ω–∏–º–∞–µ—Ç <code>-task</code> (–Ω–∞–ø—Ä–∏–º–µ—Ä, <code>support_appA</code> –∏–ª–∏ <code>dialog_summarizer</code>),</li></ul><ul id="2ab568fa-e39f-8001-93ab-ede3daae88af" class="bulleted-list"><li style="list-style-type:disc">–≥—Ä—É–∑–∏—Ç –Ω—É–∂–Ω—É—é –º–æ–¥–µ–ª—å + –∞–¥–∞–ø—Ç–µ—Ä,</li></ul><ul id="2ab568fa-e39f-8057-b749-f8198d0258cf" class="bulleted-list"><li style="list-style-type:disc">–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç <code>task_type</code>:<ul id="2ab568fa-e39f-80c6-8d2f-d36c52ca508a" class="bulleted-list"><li style="list-style-type:circle">–µ—Å–ª–∏ <code>causal_lm</code> ‚Üí –æ—Ç–≤–µ—á–∞–µ—Ç –∫–∞–∫ —Å–∞–ø–ø–æ—Ä—Ç-–±–æ—Ç,</li></ul><ul id="2ab568fa-e39f-8060-beab-f2cdc3f7dc6b" class="bulleted-list"><li style="list-style-type:circle">–µ—Å–ª–∏ <code>seq2seq_lm</code> ‚Üí –¥–µ–ª–∞–µ—Ç —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é –¥–∏–∞–ª–æ–≥–∞.</li></ul></li></ul><h3 id="2ab568fa-e39f-806e-895e-f621915ce82e" class="">8.1. –ó–∞–≥–æ—Ç–æ–≤–∫–∞ CLI</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80ae-8207-f8c6c0e543aa" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">import argparse

def parse_args():
    parser = argparse.ArgumentParser()
    parser.add_argument(
        &quot;--task&quot;,
        type=str,
        required=True,
        help=&quot;Task name from adapters_config.json (e.g. support_appA, dialog_summarizer)&quot;,
    )
    return parser.parse_args()
</code></pre><h3 id="2ab568fa-e39f-80f3-bedc-db66c0f436c2" class="">8.2. –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∑–∞–¥–∞—á</h3><ul id="2ab568fa-e39f-8044-9011-fb5e9fcbd336" class="bulleted-list"><li style="list-style-type:disc">–î–ª—è —Å–∞–ø–ø–æ—Ä—Ç-–±–æ—Ç–∞ (causal LM) ‚Äî –ø–æ—á—Ç–∏ –∫–∞–∫ –≤ 8.2.</li></ul><ul id="2ab568fa-e39f-8074-9ef3-de1e7f0c85ec" class="bulleted-list"><li style="list-style-type:disc">–î–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ç–æ—Ä–∞ (seq2seq LM) ‚Äî –∫–∞–∫ –≤ 8.3.</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8055-8590-fec161ca7809" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">def generate_support_reply(model, tokenizer, dialog: str, max_new_tokens: int = 80) -&gt; str:
    &quot;&quot;&quot;
    dialog: —Å—Ç—Ä–æ–∫–∞ —Å –ø–µ—Ä–µ–ø–∏—Å–∫–æ–π, –º—ã –ø—Ä–µ–≤—Ä–∞—Ç–∏–º –µ—ë –≤ –ø—Ä–æ–º–ø—Ç –¥–ª—è —Å–∞–ø–ø–æ—Ä—Ç-–±–æ—Ç–∞.
    –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã —Å–¥–µ–ª–∞–µ–º –æ–¥–∏–Ω –±–ª–æ–∫:
    &quot;&quot;&quot;
    prompt = f&quot;System: You are a helpful support assistant.\nDialog:\n{dialog.strip()}\n\nSupport:&quot;

    device = next(model.parameters()).device
    inputs = tokenizer(
        prompt,
        return_tensors=&quot;pt&quot;,
        truncation=True,
        max_length=512,
    ).to(device)

    with torch.no_grad():
        out_ids = model.generate(
            **inputs,
            max_new_tokens=max_new_tokens,
            do_sample=True,
            top_p=0.9,
            temperature=0.7,
            repetition_penalty=1.1,
            eos_token_id=tokenizer.eos_token_id,
        )

    input_len = inputs[&quot;input_ids&quot;].shape[1]
    new_tokens = out_ids[0][input_len:]
    reply = tokenizer.decode(new_tokens, skip_special_tokens=True).strip()

    # –ù–∞ —Å–ª—É—á–∞–π –ø–æ—è–≤–ª–µ–Ω–∏—è &quot;User:&quot; —Ä–µ–∂–µ–º
    if &quot;User:&quot; in reply:
        reply = reply.split(&quot;User:&quot;)[0].strip()

    return reply


def summarize_dialog(model, tokenizer, dialog: str, max_new_tokens: int = 64) -&gt; str:
    device = next(model.parameters()).device
    inputs = tokenizer(
        dialog,
        return_tensors=&quot;pt&quot;,
        truncation=True,
        max_length=512,
    ).to(device)

    with torch.no_grad():
        out_ids = model.generate(
            **inputs,
            max_new_tokens=max_new_tokens,
            num_beams=4,
            no_repeat_ngram_size=3,
        )

    summary = tokenizer.decode(out_ids[0], skip_special_tokens=True).strip()
    return summary
</code></pre><h3 id="2ab568fa-e39f-80b2-90ee-ef85f94305df" class="">8.3. –û—Å–Ω–æ–≤–Ω–æ–π <code>main</code></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-804e-99be-f776a66bb9a0" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">def main():
    args = parse_args()
    task_name = args.task

    model, tokenizer, task_type = load_model_with_adapter(task_name)

    print(f&quot;Loaded task=&#x27;{task_name}&#x27;, type=&#x27;{task_type}&#x27;&quot;)

    # –ü—Ä–æ—Å—Ç–µ–π—à–∏–π REPL
    while True:
        print(&quot;\n---&quot;)
        dialog = input(&quot;Enter dialog text (or empty to exit):\n&quot;)
        if not dialog.strip():
            break

        if task_type == &quot;causal_lm&quot;:
            reply = generate_support_reply(model, tokenizer, dialog)
            print(&quot;\n[Support reply]:&quot;)
            print(reply)
        elif task_type == &quot;seq2seq_lm&quot;:
            summary = summarize_dialog(model, tokenizer, dialog)
            print(&quot;\n[Summary]:&quot;)
            print(summary)
        else:
            print(f&quot;Unknown task_type={task_type}&quot;)
            break


if __name__ == &quot;__main__&quot;:
    main()
</code></pre><p id="2ab568fa-e39f-806d-be70-edf2b74e2cc8" class="">–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80f7-a070-d2f6594dbdbe" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">python src/inference_router.py --task support_appA
python src/inference_router.py --task dialog_summarizer
</code></pre><p id="2ab568fa-e39f-8096-9eba-e6a329160af5" class="">–ò –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–æ–¥ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å <strong>—Ä–∞–∑–Ω—ã–º–∏ –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏</strong> –∏ —Ç–∏–ø–∞–º–∏ –∑–∞–¥–∞—á.</p><hr id="2ab568fa-e39f-8056-b190-f808e8d16ee5"/><h2 id="2ab568fa-e39f-80da-9c9e-c83323daf598" class="">9. –î–æ–º–∞—à–∫–∞ –∫ —É—Ä–æ–∫—É 8.4 (–∏—Ç–æ–≥–æ–≤–∞—è –ø–æ –º–æ–¥—É–ª—é)</h2><h3 id="2ab568fa-e39f-80b1-b725-cad48a43ee16" class="">–ó–∞–¥–∞–Ω–∏–µ 1. –î–≤–∞ –∞–¥–∞–ø—Ç–µ—Ä–∞ ‚Äî –æ–¥–∏–Ω —Ä–æ—É—Ç–µ—Ä</h3><ol type="1" id="2ab568fa-e39f-80d8-b119-cd7cc30ab69c" class="numbered-list" start="1"><li>–°–¥–µ–ª–∞–π <strong>–º–∏–Ω–∏–º—É–º –¥–≤–∞ LoRA-–∞–¥–∞–ø—Ç–µ—Ä–∞</strong>:<ul id="2ab568fa-e39f-804b-9b3e-e13e2a0ebebe" class="bulleted-list"><li style="list-style-type:disc">–Ω–∞–ø—Ä–∏–º–µ—Ä:<ul id="2ab568fa-e39f-8004-8500-fa0e69f97a16" class="bulleted-list"><li style="list-style-type:circle"><code>support_appA_lora</code> ‚Äî –æ–±—É—á–µ–Ω –Ω–∞ –¥–∏–∞–ª–æ–≥–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è A,</li></ul><ul id="2ab568fa-e39f-8074-ad67-c428654095e3" class="bulleted-list"><li style="list-style-type:circle"><code>support_appB_lora</code> ‚Äî –ª–∏–±–æ –Ω–∞ –¥—Ä—É–≥–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ, –ª–∏–±–æ –ø—Ä–æ—Å—Ç–æ —Å –¥—Ä—É–≥–∏–º —Å—Ç–∏–ª–µ–º (–±–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π).</li></ul></li></ul></li></ol><ol type="1" id="2ab568fa-e39f-8069-932a-ee63c8e16f42" class="numbered-list" start="2"><li>–î–æ–±–∞–≤—å –∏—Ö –≤ <code>adapters_config.json</code>.</li></ol><ol type="1" id="2ab568fa-e39f-8023-b5ca-f830a8a702df" class="numbered-list" start="3"><li>–°–æ–±–µ—Ä–∏ <code>inference_router.py</code> –ø–æ —à–∞–±–ª–æ–Ω—É –≤—ã—à–µ.</li></ol><ol type="1" id="2ab568fa-e39f-805f-9e3b-c0d5679f3011" class="numbered-list" start="4"><li>–ü—Ä–æ–≤–µ—Ä—å:<ul id="2ab568fa-e39f-8037-bdcd-c03726b0c869" class="bulleted-list"><li style="list-style-type:disc">–∑–∞–ø—É—Å–∫ <code>-task support_appA</code> –∏ <code>-task support_appB</code>,</li></ul><ul id="2ab568fa-e39f-80f8-9e8e-e96a47af424d" class="bulleted-list"><li style="list-style-type:disc">—á—Ç–æ –æ—Ç–≤–µ—Ç—ã —Ä–µ–∞–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –ø–æ —Å—Ç–∏–ª—é/–ø–æ–≤–µ–¥–µ–Ω–∏—é.</li></ul></li></ol><h3 id="2ab568fa-e39f-8012-ad8f-f46a65319b39" class="">–ó–∞–¥–∞–Ω–∏–µ 2. Merge –æ–¥–Ω–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞</h3><ol type="1" id="2ab568fa-e39f-8057-9360-e33f2323da65" class="numbered-list" start="1"><li>–í–æ–∑—å–º–∏ –æ–¥–∏–Ω –∞–¥–∞–ø—Ç–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, <code>support_appA_lora</code>).</li></ol><ol type="1" id="2ab568fa-e39f-80ed-8dcf-c7f67625615d" class="numbered-list" start="2"><li>–°–¥–µ–ª–∞–π merge –≤ –±–∞–∑–æ–≤—É—é –º–æ–¥–µ–ª—å:<ul id="2ab568fa-e39f-8055-8255-f09dd5382135" class="bulleted-list"><li style="list-style-type:disc">–∏—Å–ø–æ–ª—å–∑—É–π <code>merge_and_unload</code>,</li></ul><ul id="2ab568fa-e39f-8095-a75d-db7f016618fc" class="bulleted-list"><li style="list-style-type:disc">—Å–æ—Ö—Ä–∞–Ω–∏ –≤ <code>models/merged/support_appA_merged</code>.</li></ul></li></ol><ol type="1" id="2ab568fa-e39f-80f7-bd29-d1b8239ffa5d" class="numbered-list" start="3"><li>–ù–∞–ø–∏—à–∏ —Å–∫—Ä–∏–ø—Ç <code>compare_lora_vs_merged.py</code>, –∫–æ—Ç–æ—Ä—ã–π:<ul id="2ab568fa-e39f-808a-aa61-da972a840121" class="bulleted-list"><li style="list-style-type:disc">–≥—Ä—É–∑–∏—Ç:<ul id="2ab568fa-e39f-80df-8b33-daa80ab7c386" class="bulleted-list"><li style="list-style-type:circle">base+LoRA,</li></ul><ul id="2ab568fa-e39f-8093-b066-cc5097c7d5e2" class="bulleted-list"><li style="list-style-type:circle">merged-–º–æ–¥–µ–ª—å,</li></ul></li></ul><ul id="2ab568fa-e39f-8094-9789-d279d2baa823" class="bulleted-list"><li style="list-style-type:disc">–ø—Ä–æ–≥–æ–Ω—è–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –¥–∏–∞–ª–æ–≥–∏,</li></ul><ul id="2ab568fa-e39f-80ad-a969-f3ba2c57208d" class="bulleted-list"><li style="list-style-type:disc">—Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç:<ul id="2ab568fa-e39f-80f2-8910-f5ad9caf5f1f" class="bulleted-list"><li style="list-style-type:circle">—Å–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ —Ç–µ–∫—Å—Ç (–º–æ–∂–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –∏–∑-–∑–∞ —Ä–∞–Ω–¥–æ–º–∞),</li></ul><ul id="2ab568fa-e39f-8097-b7b9-e4b0222d1deb" class="bulleted-list"><li style="list-style-type:circle">—Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞,</li></ul><ul id="2ab568fa-e39f-8087-afd7-ce1685952673" class="bulleted-list"><li style="list-style-type:circle">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (–Ω–∞ –≥–ª–∞–∑/—á–µ—Ä–µ–∑ <code>nvidia-smi</code>).</li></ul></li></ul></li></ol><h3 id="2ab568fa-e39f-8053-a031-c20981763d1c" class="">–ó–∞–¥–∞–Ω–∏–µ 3. –ü–æ–¥—É–º–∞—Ç—å –ø—Ä–æ –ø—Ä–æ–¥</h3><p id="2ab568fa-e39f-80a8-9f06-fe6f514e1bd8" class="">–ù–∞–ø–∏—à–∏ —Å–µ–±–µ (–º–æ–∂–Ω–æ –≤ markdown-—Ñ–∞–π–ª–µ):</p><ul id="2ab568fa-e39f-806a-b05b-f22cd4277abe" class="bulleted-list"><li style="list-style-type:disc">–í –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö —Ç—ã –±—É–¥–µ—à—å:<ul id="2ab568fa-e39f-80fa-9cef-ef2e37b24722" class="bulleted-list"><li style="list-style-type:circle">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <strong>–æ—Ç–¥–µ–ª—å–Ω—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã + PeftModel</strong>,</li></ul><ul id="2ab568fa-e39f-80c4-8670-ef71b9c0c869" class="bulleted-list"><li style="list-style-type:circle">–∞ –≤ –∫–∞–∫–∏—Ö ‚Äî <strong>–¥–µ–ª–∞—Ç—å merge</strong> –∏ –¥–µ–ø–ª–æ–∏—Ç—å –º–æ–Ω–æ–ª–∏—Ç–Ω—É—é –º–æ–¥–µ–ª—å?</li></ul></li></ul><ul id="2ab568fa-e39f-80fd-bdf1-ded2a77a0c93" class="bulleted-list"><li style="list-style-type:disc">–ö–∞–∫ –±—ã —Ç—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–ª:<ul id="2ab568fa-e39f-8062-b5ff-f4d99474f4c9" class="bulleted-list"><li style="list-style-type:circle">–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∏–∞–ª–æ–≥–∞—Ö),</li></ul><ul id="2ab568fa-e39f-803a-8b58-cc9bc402e8ce" class="bulleted-list"><li style="list-style-type:circle">–æ—Ç–∫–∞—Ç (rollback), –µ—Å–ª–∏ –Ω–æ–≤—ã–π –∞–¥–∞–ø—Ç–µ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç —Ç–≤–æ—Ä–∏—Ç—å –¥–∏—á—å?</li></ul></li></ul><hr id="2ab568fa-e39f-80d7-8cc0-dae1ceaf8000"/><p id="2ab568fa-e39f-80be-b200-c167a1ecf320" class="">–ù–∞ —ç—Ç–æ–º <strong>–º–æ–¥—É–ª—å 8 –∑–∞–≤–µ—Ä—à—ë–Ω</strong>:</p><ul id="2ab568fa-e39f-80f7-94a3-c55fd0a2cf76" class="bulleted-list"><li style="list-style-type:disc">8.1 ‚Äî —Ç—ã –ø–æ–Ω—è–ª, —á—Ç–æ —Ç–∞–∫–æ–µ LoRA –∏ –∑–∞—á–µ–º.</li></ul><ul id="2ab568fa-e39f-80ba-9bbe-f3853c346619" class="bulleted-list"><li style="list-style-type:disc">8.2 ‚Äî —Å–¥–µ–ª–∞–ª LoRA-–±–æ—Ç–∞.</li></ul><ul id="2ab568fa-e39f-8018-be48-cbeca3f901fa" class="bulleted-list"><li style="list-style-type:disc">8.3 ‚Äî —Å–¥–µ–ª–∞–ª LoRA-—Å—É–º–º–∞—Ä–∏–∑–∞—Ç–æ—Ä.</li></ul><ul id="2ab568fa-e39f-803c-b13a-e134d9400c66" class="bulleted-list"><li style="list-style-type:disc">8.4 ‚Äî –Ω–∞—É—á–∏–ª—Å—è –∂–∏—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞–¥–∞–ø—Ç–µ—Ä–∞–º–∏ –∏ –¥–µ–ø–ª–æ–∏—Ç—å —ç—Ç–æ –ø–æ-—á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏.</li></ul><p id="2ab568fa-e39f-80c5-8332-faf170077884" class="">–î–∞–ª—å—à–µ –º–æ–∂–Ω–æ —É–∂–µ –¥—É–º–∞—Ç—å –ø—Ä–æ —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å:</p><p id="2ab568fa-e39f-80d5-92dd-de364704b11c" class="">–æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ LLM (eval-—Ä–∞–º–∫–∏), safety, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, FastAPI/Docker, –≤—Å—ë –≤–æ—Ç —ç—Ç–æ –ø—Ä–æ–¥–æ–≤—Å–∫–æ–µ. –ï—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å, –º–æ–∂–µ–º —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —Å–æ–±—Ä–∞—Ç—å <strong>–æ–±—â–∏–π –ø–ª–∞–Ω ‚Äú–ø—Ä–æ–¥ LLM-—Å—Ç–µ–∫–∞‚Äù</strong> –ø–æ–≤–µ—Ä—Ö —Ç–≤–æ–µ–≥–æ –∫—É—Ä—Å–∞.</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>