<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>–£—Ä–æ–∫ 5.1. –ü–µ—Ä–≤–∞—è seq2seq-–º–æ–¥–µ–ª—å: –¥–µ–ª–∞–µ–º —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é –¥–∏–∞–ª–æ–≥–∞ —á–µ—Ä–µ–∑ generate()</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2ab568fa-e39f-8093-a340-fda416d221e3" class="page sans"><header><h1 class="page-title">–£—Ä–æ–∫ 5.1. –ü–µ—Ä–≤–∞—è seq2seq-–º–æ–¥–µ–ª—å: –¥–µ–ª–∞–µ–º —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é –¥–∏–∞–ª–æ–≥–∞ —á–µ—Ä–µ–∑ <code>generate()</code></h1><p class="page-description"></p></header><div class="page-body"><p id="2ab568fa-e39f-80ce-9e44-de4b199310af" class="">–û–∫–µ–π, –¥–µ–ª–∞–µ–º –∏–∑ 5.1 –ø—Ä—è–º –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —É—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –±—Ä–∞—Ç—å –∏ —á–∏—Ç–∞—Ç—å —É—á–µ–Ω–∏–∫–∞–º üí™</p><hr id="2ab568fa-e39f-802d-8a61-fe8e8fe452e2"/><h2 id="2ab568fa-e39f-802b-b903-c12df5dd892b" class="">1. –¶–µ–ª—å —É—Ä–æ–∫–∞</h2><p id="2ab568fa-e39f-8000-83d2-d004d25602be" class="">–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞ —É—á–µ–Ω–∏–∫ –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å:</p><ul id="2ab568fa-e39f-80e1-9211-d7868787fb83" class="bulleted-list"><li style="list-style-type:disc">–ø–æ–Ω–∏–º–∞—Ç—å <strong>–Ω–∞ —É—Ä–æ–≤–Ω–µ –∏–Ω—Ç—É–∏—Ü–∏–∏</strong>, —á—Ç–æ —Ç–∞–∫–æ–µ encoder-decoder (seq2seq) –º–æ–¥–µ–ª—å;</li></ul><ul id="2ab568fa-e39f-802b-b2a2-c1cb3bf9cb93" class="bulleted-list"><li style="list-style-type:disc">–≥—Ä—É–∑–∏—Ç—å <code>AutoTokenizer</code> + <code>AutoModelForSeq2SeqLM</code>;</li></ul><ul id="2ab568fa-e39f-803a-963c-c8a956c8cbc9" class="bulleted-list"><li style="list-style-type:disc">—Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥ –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å <code>model.generate()</code> –¥–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏;</li></ul><ul id="2ab568fa-e39f-8021-83c2-f58efb20938e" class="bulleted-list"><li style="list-style-type:disc">—É–ø—Ä–∞–≤–ª—è—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:<ul id="2ab568fa-e39f-806d-8d43-e972171c0f85" class="bulleted-list"><li style="list-style-type:circle">greedy,</li></ul><ul id="2ab568fa-e39f-804c-b2a3-f8ecfc42d3f3" class="bulleted-list"><li style="list-style-type:circle">beam search,</li></ul><ul id="2ab568fa-e39f-8007-bbe8-f7dd2daea0c2" class="bulleted-list"><li style="list-style-type:circle">sampling (<code>top_k</code>, <code>top_p</code>, <code>temperature</code>);</li></ul></li></ul><ul id="2ab568fa-e39f-8070-a273-c89261073ea7" class="bulleted-list"><li style="list-style-type:disc">–≤–∏–¥–µ—Ç—å, –∫–∞–∫ —Å–∏–ª—å–Ω–æ –æ—Ç —ç—Ç–æ–≥–æ –º–µ–Ω—è–µ—Ç—Å—è –∫–∞—á–µ—Å—Ç–≤–æ –∏ —Å—Ç–∏–ª—å —Ç–µ–∫—Å—Ç–∞.</li></ul><p id="2ab568fa-e39f-80ce-8a56-dfe7ef62a2a2" class="">–ú—ã –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –Ω–∞—à <strong>–∫–µ–π—Å —Å–∞–ø–ø–æ—Ä—Ç–∞</strong>:</p><blockquote id="2ab568fa-e39f-80bf-b1b1-dd150a1a7e74" class="">–ï—Å—Ç—å –¥–ª–∏–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥ ‚Äú–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üî –ø–æ–¥–¥–µ—Ä–∂–∫–∞‚Äù.<p id="2ab568fa-e39f-8077-acda-f644e56e40a6" class="">–ó–∞–¥–∞—á–∞ ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–¥–µ–ª–∞—Ç—å <strong>–∫–æ—Ä–æ—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ</strong>: —á—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å, –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –≤—Å—ë –∑–∞–≤–∏—Å–ª–æ, —á—Ç–æ –ø–æ—Ñ–∏–∫—Å–∏–ª–∏ / –ø–ª–∞–Ω–∏—Ä—É–µ–º.</p></blockquote><hr id="2ab568fa-e39f-8089-9457-e615f5fd204a"/><h2 id="2ab568fa-e39f-8018-8d4a-fb5b8b6f0f08" class="">2. –¢–µ–æ—Ä–∏—è: —á—Ç–æ —Ç–∞–∫–æ–µ seq2seq –º–æ–¥–µ–ª—å –∏ —á–µ–º –æ–Ω–∞ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç ‚Äú–æ–±—ã—á–Ω–æ–π‚Äù</h2><p id="2ab568fa-e39f-80a1-a703-d1aa7a6e9aa8" class="">–ë–µ–∑ —Ç–µ–æ—Ä. –∫–æ—à–º–∞—Ä–∞, —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –Ω–∞–¥–æ –¥–ª—è –∫–æ–¥–∞.</p><h3 id="2ab568fa-e39f-8044-b6e0-db42d4c7a793" class="">2.1. Encoder-decoder –Ω–∞ –ø–∞–ª—å—Ü–∞—Ö</h3><p id="2ab568fa-e39f-8008-959a-d9fa0435b481" class="">–ï—Å—Ç—å —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–µ–º–µ–π—Å—Ç–≤–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤:</p><ol type="1" id="2ab568fa-e39f-8038-b013-f3063dcde77a" class="numbered-list" start="1"><li><strong>Encoder-only</strong> (BERT-–ø–æ–¥–æ–±–Ω—ã–µ):<ul id="2ab568fa-e39f-80d8-9fe8-d4ed28564138" class="bulleted-list"><li style="list-style-type:disc">—Ö–æ—Ä–æ—à–æ –¥–ª—è –∑–∞–¥–∞—á —Ç–∏–ø–∞:<ul id="2ab568fa-e39f-808f-ad2a-e2e0d633cbfa" class="bulleted-list"><li style="list-style-type:circle">–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞,</li></ul><ul id="2ab568fa-e39f-80ad-bfdd-eb0e4f52fcfd" class="bulleted-list"><li style="list-style-type:circle">NER,</li></ul><ul id="2ab568fa-e39f-8062-a8d0-e90aa4354f2e" class="bulleted-list"><li style="list-style-type:circle">–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.</li></ul></li></ul><ul id="2ab568fa-e39f-809b-ac07-d910541841e9" class="bulleted-list"><li style="list-style-type:disc">–ù–∞ –≤—Ö–æ–¥: —Ç–µ–∫—Å—Ç ‚Üí –Ω–∞ –≤—ã—Ö–æ–¥: –≤–µ–∫—Ç–æ—Ä–∞/–ª–æ–≥–∏—Ç—ã.</li></ul></li></ol><ol type="1" id="2ab568fa-e39f-8075-a548-ecfe3e713061" class="numbered-list" start="2"><li><strong>Decoder-only</strong> (GPT-–ø–æ–¥–æ–±–Ω—ã–µ):<ul id="2ab568fa-e39f-807d-9475-e1bba65236bb" class="bulleted-list"><li style="list-style-type:disc">—Ö–æ—Ä–æ—à–æ –¥–ª—è:<ul id="2ab568fa-e39f-8058-b03d-cd1fe10c1ea6" class="bulleted-list"><li style="list-style-type:circle">–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞,</li></ul><ul id="2ab568fa-e39f-8058-979f-c294cb6027ff" class="bulleted-list"><li style="list-style-type:circle">—á–∞—Ç-–±–æ—Ç—ã,</li></ul><ul id="2ab568fa-e39f-806d-b672-da9cb0a592ff" class="bulleted-list"><li style="list-style-type:circle">–≥–µ–Ω–µ—Ä–∞—Ü–∏—è.</li></ul></li></ul><ul id="2ab568fa-e39f-8018-bfb5-f1023f3a48f0" class="bulleted-list"><li style="list-style-type:disc">–ú–æ–¥–µ–ª—å ‚Äú—Å–º–æ—Ç—Ä–∏—Ç –Ω–∞–∑–∞–¥‚Äù –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–∫–µ–Ω.</li></ul></li></ol><ol type="1" id="2ab568fa-e39f-8052-9088-d9e3d475814b" class="numbered-list" start="3"><li><strong>Encoder-decoder (seq2seq)</strong> (T5, BART –∏ —Ç.–ø.):<ul id="2ab568fa-e39f-8017-ac36-dcaea0f68f96" class="bulleted-list"><li style="list-style-type:disc">–≤—Ö–æ–¥: <strong>–æ–¥–∏–Ω —Ç–µ–∫—Å—Ç</strong> (source),</li></ul><ul id="2ab568fa-e39f-800d-8277-fb135c4f7cae" class="bulleted-list"><li style="list-style-type:disc">–≤—ã—Ö–æ–¥: <strong>–¥—Ä—É–≥–æ–π —Ç–µ–∫—Å—Ç</strong> (target),</li></ul><ul id="2ab568fa-e39f-80bf-871f-fcfbcd3f30c1" class="bulleted-list"><li style="list-style-type:disc">–ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è:<ul id="2ab568fa-e39f-80cd-af45-c74fe4c33a42" class="bulleted-list"><li style="list-style-type:circle">—Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏,</li></ul><ul id="2ab568fa-e39f-808f-b9bd-c7981152a5d4" class="bulleted-list"><li style="list-style-type:circle">–ø–µ—Ä–µ–≤–æ–¥–∞,</li></ul><ul id="2ab568fa-e39f-8048-91dc-feb02f5570ef" class="bulleted-list"><li style="list-style-type:circle">–ø–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä–æ–≤–∞–Ω–∏—è,</li></ul><ul id="2ab568fa-e39f-80ef-bf48-cbe7c79e3c7a" class="bulleted-list"><li style="list-style-type:circle">‚Äú–≤–æ–ø—Ä–æ—Å ‚Üí –æ—Ç–≤–µ—Ç‚Äù –∏ —Ç.–ø.</li></ul></li></ul></li></ol><p id="2ab568fa-e39f-8095-9791-d5e173314172" class="">–°—Ö–µ–º–∞ seq2seq:</p><ol type="1" id="2ab568fa-e39f-80e2-a643-c45335e26d38" class="numbered-list" start="1"><li><strong>Encoder</strong> —á–∏—Ç–∞–µ—Ç –≤–µ—Å—å –≤—Ö–æ–¥–Ω–æ–π —Ç–µ–∫—Å—Ç ‚Üí –¥–µ–ª–∞–µ—Ç –Ω–∞–±–æ—Ä —Å–∫—Ä—ã—Ç—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π.</li></ol><ol type="1" id="2ab568fa-e39f-8011-a388-ff0cca727260" class="numbered-list" start="2"><li><strong>Decoder</strong> –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤—ã—Ö–æ–¥–Ω–æ–π —Ç–µ–∫—Å—Ç, –æ–ø–∏—Ä–∞—è—Å—å:<ul id="2ab568fa-e39f-80b4-b792-df4313b70c5e" class="bulleted-list"><li style="list-style-type:disc">–Ω–∞ —Å–∫—Ä—ã—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —ç–Ω–∫–æ–¥–µ—Ä–∞,</li></ul><ul id="2ab568fa-e39f-80ea-bf96-d67783d1b43b" class="bulleted-list"><li style="list-style-type:disc">–∏ –Ω–∞ —É–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã.</li></ul></li></ol><p id="2ab568fa-e39f-8010-8988-c79bc4c3a0df" class="">–í–æ—Ç –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞–º –Ω—É–∂–Ω—ã –¥–ª—è <strong>‚Äú–¥–∏–∞–ª–æ–≥ ‚Üí —Ä–µ–∑—é–º–µ‚Äù</strong>.</p><h3 id="2ab568fa-e39f-8031-a899-f8e9c481a641" class="">2.2. –ö–∞–∫ Hugging Face —ç—Ç–æ —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç</h3><p id="2ab568fa-e39f-80e9-afe9-d6ff948eb4f1" class="">–î–ª—è seq2seq –≤ HF –µ—Å—Ç—å –∫–ª–∞—Å—Å:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-803d-bfeb-c394300840eb" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">AutoModelForSeq2SeqLM
</code></pre><p id="2ab568fa-e39f-80a1-910a-f5eb9086dda3" class="">–û–Ω:</p><ul id="2ab568fa-e39f-8044-b2cc-e5217392cf7e" class="bulleted-list"><li style="list-style-type:disc">–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º –±–µ—Ä—ë—Ç –Ω—É–∂–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É (T5, BART –∏ —Ç.–ø.),</li></ul><ul id="2ab568fa-e39f-8085-af6f-d26ae27fddd3" class="bulleted-list"><li style="list-style-type:disc">—É–º–µ–µ—Ç:<ul id="2ab568fa-e39f-8026-bf38-cb3d41f1bec1" class="bulleted-list"><li style="list-style-type:circle">—Å—á–∏—Ç–∞—Ç—å loss (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å <code>labels</code>),</li></ul><ul id="2ab568fa-e39f-806b-bb6b-d8ecd0016093" class="bulleted-list"><li style="list-style-type:circle">–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç —á–µ—Ä–µ–∑ <code>.generate()</code>.</li></ul></li></ul><p id="2ab568fa-e39f-80c3-8af1-c4e4539f71c5" class="">–ò –µ—â—ë:</p><ul id="2ab568fa-e39f-806d-bda5-eae5779c35ef" class="bulleted-list"><li style="list-style-type:disc"><code>AutoTokenizer</code>:<ul id="2ab568fa-e39f-806d-976a-cc52a8b054c2" class="bulleted-list"><li style="list-style-type:circle">–∑–Ω–∞–µ—Ç, –∫–∞–∫ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∏ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è —ç—Ç–æ–π –º–æ–¥–µ–ª–∏,</li></ul><ul id="2ab568fa-e39f-8045-abd7-d74ce4c79b26" class="bulleted-list"><li style="list-style-type:circle">—É –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–æ–¥–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä T5) –µ—Å—Ç—å —Å—Ç–∏–ª–µ–≤—ã–µ –ø—Ä–æ–º–ø—Ç—ã: <code>&quot;summarize: &lt;—Ç–µ–∫—Å—Ç&gt;&quot;</code>.</li></ul></li></ul><h3 id="2ab568fa-e39f-80fe-b129-d973dd5acf2d" class="">2.3. <code>generate()</code> ‚Äî –∫–∞–∫ –º–æ–∑–≥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</h3><p id="2ab568fa-e39f-8018-8c5a-d1de21a5e17a" class="">–ú–µ—Ç–æ–¥:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8024-a2e3-f5ca445a9bf7" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">model.generate(input_ids, attention_mask, ...)
</code></pre><p id="2ab568fa-e39f-80d4-b75c-e83855f28fbd" class="">–¥–µ–ª–∞–µ—Ç —Ç—Ä–∏ –≤–µ—â–∏:</p><ol type="1" id="2ab568fa-e39f-808b-912e-ef4a05bfbe52" class="numbered-list" start="1"><li>–ë–µ—Ä—ë—Ç –≤—Ö–æ–¥ (—ç–Ω–∫–æ–¥–µ—Ä),</li></ol><ol type="1" id="2ab568fa-e39f-80f8-a220-cce345f59217" class="numbered-list" start="2"><li>–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã (–¥–µ–∫–æ–¥–µ—Ä),</li></ol><ol type="1" id="2ab568fa-e39f-8065-bc37-f1be67edeba5" class="numbered-list" start="3"><li>–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å <code>output_ids</code> (–∏–Ω–¥–µ–∫—Å—ã —Ç–æ–∫–µ–Ω–æ–≤).</li></ol><p id="2ab568fa-e39f-80a5-a2e1-fb0629228837" class="">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã –±—É–¥–µ–º –∏–≥—Ä–∞—Ç—å:</p><ul id="2ab568fa-e39f-805a-b3c6-e47639b6be2a" class="bulleted-list"><li style="list-style-type:disc"><strong>–¥–ª–∏–Ω–∞</strong>:<ul id="2ab568fa-e39f-8095-a05f-f20b1b76fd53" class="bulleted-list"><li style="list-style-type:circle"><code>max_new_tokens</code> / <code>max_length</code>,</li></ul><ul id="2ab568fa-e39f-8064-8d6f-f36f9663cad1" class="bulleted-list"><li style="list-style-type:circle"><code>min_length</code>;</li></ul></li></ul><ul id="2ab568fa-e39f-80ee-94b2-e6e30521ae49" class="bulleted-list"><li style="list-style-type:disc"><strong>—Å—Ç—Ä–∞—Ç–µ–≥–∏—è</strong>:<ul id="2ab568fa-e39f-8085-ade1-c257d12e7add" class="bulleted-list"><li style="list-style-type:circle">greedy: <code>num_beams=1</code>, <code>do_sample=False</code>,</li></ul><ul id="2ab568fa-e39f-8064-996e-eb7f03cac3b2" class="bulleted-list"><li style="list-style-type:circle">beam search: <code>num_beams&gt;1</code>, <code>do_sample=False</code>,</li></ul><ul id="2ab568fa-e39f-80c4-81fd-f85b015bdd2b" class="bulleted-list"><li style="list-style-type:circle">sampling: <code>do_sample=True</code>, <code>top_k</code>, <code>top_p</code>, <code>temperature</code>;</li></ul></li></ul><ul id="2ab568fa-e39f-8088-bf02-e1a1a1bfbe51" class="bulleted-list"><li style="list-style-type:disc"><strong>–∫–∞—á–µ—Å—Ç–≤–æ</strong>:<ul id="2ab568fa-e39f-8017-abea-c485b987612d" class="bulleted-list"><li style="list-style-type:circle"><code>no_repeat_ngram_size</code> (—á—Ç–æ–±—ã –Ω–µ –∑–∞–∏–∫–∞–ª–∞—Å—å),</li></ul><ul id="2ab568fa-e39f-803c-939f-f6446ef142b3" class="bulleted-list"><li style="list-style-type:circle"><code>length_penalty</code>.</li></ul></li></ul><hr id="2ab568fa-e39f-80cb-bd4e-ffb157c10821"/><h2 id="2ab568fa-e39f-80bd-8600-f1e4cbbaa988" class="">3. –ü—Ä–∞–∫—Ç–∏–∫–∞, —á–∞—Å—Ç—å 1. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫: —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞</h2><h3 id="2ab568fa-e39f-8034-b8e7-ec2739be052d" class="">3.1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏–º–ø–æ—Ä—Ç</h3><p id="2ab568fa-e39f-80ef-90ea-d23cd748d18c" class="">–ï—Å–ª–∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –µ—â—ë —á–∏—Å—Ç–æ–µ:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8020-b8ca-d808a7e705e2" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">pip install transformers accelerate
</code></pre><p id="2ab568fa-e39f-8021-85cb-d960c9a48533" class="">–í —É—Ä–æ–∫–µ –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –≤—Å—ë —É–∂–µ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–æ.</p><p id="2ab568fa-e39f-8044-9b2a-ce575f028de7" class="">–î–∞–ª—å—à–µ ‚Äî –∫–æ–¥:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8061-9c6a-fc4f615b8009" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">import torch
from transformers import AutoTokenizer, AutoModelForSeq2SeqLM
</code></pre><p id="2ab568fa-e39f-80e5-adfd-c399e27181de" class=""><strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:</strong></p><ul id="2ab568fa-e39f-803e-8f12-ce3cf380d455" class="bulleted-list"><li style="list-style-type:disc"><code>AutoTokenizer</code> ‚Äî –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø–µ—Ä–µ–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ ‚Üî —Ç–æ–∫–µ–Ω—ã.</li></ul><ul id="2ab568fa-e39f-801d-97ba-fb8312ed3091" class="bulleted-list"><li style="list-style-type:disc"><code>AutoModelForSeq2SeqLM</code> ‚Äî —Å–∞–º–∞ seq2seq –º–æ–¥–µ–ª—å, —É–º–µ—é—â–∞—è –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å.</li></ul><h3 id="2ab568fa-e39f-80c8-8e0c-f58141608495" class="">3.2. –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å –¥–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏</h3><p id="2ab568fa-e39f-8051-8a74-d3b8133f44f7" class="">–í–æ–∑—å–º—ë–º –ø–æ–ø—É–ª—è—Ä–Ω—É—é –º–æ–¥–µ–ª—å —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, BART):</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80c6-893c-c6318427269d" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">model_id = &quot;facebook/bart-large-cnn&quot;

tokenizer = AutoTokenizer.from_pretrained(model_id)
model = AutoModelForSeq2SeqLM.from_pretrained(model_id)
</code></pre><p id="2ab568fa-e39f-8070-a65e-c0aba8f0360c" class=""><strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:</strong></p><ul id="2ab568fa-e39f-8026-8beb-f519d14a5889" class="bulleted-list"><li style="list-style-type:disc"><code>from_pretrained(model_id)</code>:<ul id="2ab568fa-e39f-8026-bb35-ed58a79c9ce9" class="bulleted-list"><li style="list-style-type:circle">–∫–∞—á–∞–µ—Ç –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ –∏ –∫–æ–Ω—Ñ–∏–≥,</li></ul><ul id="2ab568fa-e39f-80e9-83ee-c6882f2eef77" class="bulleted-list"><li style="list-style-type:circle">—Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä ‚Äî —Å–ª–æ–≤–∞—Ä—å —Ç–æ–∫–µ–Ω–æ–≤ + –ø—Ä–∞–≤–∏–ª–∞,</li></ul><ul id="2ab568fa-e39f-8098-8b94-fc0f921f0570" class="bulleted-list"><li style="list-style-type:circle">–º–æ–¥–µ–ª—å ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ + –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –≤–µ—Å–∞.</li></ul></li></ul><ul id="2ab568fa-e39f-803e-89c6-ef5d9e107007" class="bulleted-list"><li style="list-style-type:disc"><code>bart-large-cnn</code> –æ–±—É—á–∞–ª—Å—è –Ω–∞ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π ‚Äî –Ω–µ –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏, –Ω–æ –¥–ª—è –∫—É—Ä—Å–∞ –≥–æ–¥–∏—Ç—Å—è.</li></ul><p id="2ab568fa-e39f-8095-ab05-ef7f699792fc" class="">–ï—Å–ª–∏ –µ—Å—Ç—å GPU, –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –Ω–∞ –Ω–µ–≥–æ –ø–µ—Ä–µ—Å–∞–¥–∏—Ç—å:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8014-9982-f8ae3f75622d" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">device = torch.device(&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;)
model.to(device)
</code></pre><h3 id="2ab568fa-e39f-8000-8365-d8e37821a7ed" class="">3.3. –í–æ–∑—å–º—ë–º –ø—Ä–∏–º–µ—Ä –¥–∏–∞–ª–æ–≥–∞</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80a5-8444-db5e2566a969" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">dialog = &quot;&quot;&quot;
User: Hi, I updated the app yesterday and now it crashes whenever I open the gallery.
Support: Sorry to hear that. Could you tell me your device and OS version?
User: It&#x27;s an iPhone 13 with iOS 17.1, app version 5.2.1.
Support: Thanks! Does it crash anywhere else or only in the gallery?
User: Only in the gallery when I try to upload or preview images.
Support: Got it, we are aware of this bug on iOS 17.1 in 5.2.1 and working on a fix for this week.
&quot;&quot;&quot;
</code></pre><h3 id="2ab568fa-e39f-8095-8251-f286fa78b4e8" class="">3.4. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –¥–∏–∞–ª–æ–≥–∞</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8055-b87d-ecaffce6e105" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">inputs = tokenizer(
    dialog,
    return_tensors=&quot;pt&quot;,    # —Ö–æ—Ç–∏–º PyTorch —Ç–µ–Ω–∑–æ—Ä—ã
    truncation=True,        # –æ–±—Ä–µ–∂–µ–º, –µ—Å–ª–∏ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π
    max_length=512,         # –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –≤—Ö–æ–¥–∞
)

print(inputs.keys())
print(inputs[&quot;input_ids&quot;].shape)
print(inputs[&quot;attention_mask&quot;].shape)
</code></pre><p id="2ab568fa-e39f-8070-a1a5-d9f18139394b" class=""><strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:</strong></p><ul id="2ab568fa-e39f-8062-b0ff-e328d3cb1d83" class="bulleted-list"><li style="list-style-type:disc"><code>input_ids</code>: —Ä–∞–∑–º–µ—Ä <code>[1, seq_len]</code> ‚Äî –∏–Ω–¥–µ–∫—Å—ã —Ç–æ–∫–µ–Ω–æ–≤.</li></ul><ul id="2ab568fa-e39f-80c8-b354-c5641afb7a61" class="bulleted-list"><li style="list-style-type:disc"><code>attention_mask</code>: <code>[1, seq_len]</code> ‚Äî –≥–¥–µ 1 = —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω, 0 = –ø–∞–¥–¥–∏–Ω–≥.</li></ul><ul id="2ab568fa-e39f-8045-8570-e34fffcc9091" class="bulleted-list"><li style="list-style-type:disc">–µ—Å–ª–∏ –¥–∏–∞–ª–æ–≥ –±—É–¥–µ—Ç –¥–ª–∏–Ω–Ω–µ–µ, —á–µ–º <code>max_length</code>, –æ–Ω –æ–±—Ä–µ–∂–µ—Ç—Å—è —Å–ø—Ä–∞–≤–∞ (—ç—Ç–æ –≤–∞–∂–Ω–æ, –Ω–æ –¥–ª—è —É—Ä–æ–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –±–µ–∑ <code>truncation=True</code> –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞).</li></ul><p id="2ab568fa-e39f-805c-a08c-e61a8f841d50" class="">–ù–µ –∑–∞–±—ã–≤–∞–µ–º, –µ—Å–ª–∏ –º–æ–¥–µ–ª—å –Ω–∞ GPU:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80dc-8057-ee6a5df757df" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">inputs = {k: v.to(device) for k, v in inputs.items()}
</code></pre><h3 id="2ab568fa-e39f-8035-82a8-f223ce501938" class="">3.5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∑—é–º–µ</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8012-9547-ce9f7d9bbc15" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">with torch.no_grad():  # –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –Ω–µ –Ω—É–∂–Ω—ã –ø—Ä–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–µ
    summary_ids = model.generate(
        **inputs,
        max_new_tokens=60,      # —Å–∫–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω–æ–≤ –º–∞–∫—Å–∏–º—É–º –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
        min_length=20,          # –º–∏–Ω–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤ (—á—Ç–æ–±—ã –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª–∞ –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º)
        num_beams=4,            # beam search —Å 4 –ª—É—á–∞–º–∏
        length_penalty=1.0,     # —à—Ç—Ä–∞—Ñ –∑–∞ –¥–ª–∏–Ω—É
        no_repeat_ngram_size=3, # –∑–∞–ø—Ä–µ—â–∞–µ–º –ø–æ–≤—Ç–æ—Ä 3-–≥—Ä–∞–º–º
    )
</code></pre><p id="2ab568fa-e39f-80d3-b47d-fe182f1534c5" class="">–ß—Ç–æ —Ç—É—Ç –≤–∞–∂–Ω–æ:</p><ul id="2ab568fa-e39f-809a-8e2b-c680940d34ba" class="bulleted-list"><li style="list-style-type:disc"><code>max_new_tokens=60</code> ‚Äî –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É <strong>–≤—ã—Ö–æ–¥–∞</strong>, –∞ –Ω–µ —Å—É–º–º–∞—Ä–Ω—É—é –¥–ª–∏–Ω—É input+output.</li></ul><ul id="2ab568fa-e39f-8026-8596-c320ce4a21a5" class="bulleted-list"><li style="list-style-type:disc"><code>num_beams=4</code>:<ul id="2ab568fa-e39f-8066-bd37-ffd3b59027dd" class="bulleted-list"><li style="list-style-type:circle">beam search: –º–æ–¥–µ–ª—å –ø—Ä–æ–±—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª—É—á—à–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω.</li></ul></li></ul><ul id="2ab568fa-e39f-803f-8f4a-d2f6625a37b8" class="bulleted-list"><li style="list-style-type:disc"><code>no_repeat_ngram_size=3</code>:<ul id="2ab568fa-e39f-807b-9b20-cea2eb10e7a6" class="bulleted-list"><li style="list-style-type:circle">–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä –∫—É—Å–æ—á–∫–æ–≤ —Ç–∏–ø–∞ <code>&quot;the app the app the app&quot;</code>.</li></ul></li></ul><p id="2ab568fa-e39f-8080-8fb2-ec209843bada" class="">–¢–µ–ø–µ—Ä—å –¥–µ–∫–æ–¥–∏—Ä—É–µ–º:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8097-a472-e272b5aa45bf" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">summary = tokenizer.decode(summary_ids[0], skip_special_tokens=True)
print(&quot;SUMMARY:&quot;)
print(summary)
</code></pre><p id="2ab568fa-e39f-80ac-a483-c527bad8fe33" class=""><strong>–û–±—ä—è—Å–Ω–µ–Ω–∏—è:</strong></p><ul id="2ab568fa-e39f-8070-88d4-e0fb43238242" class="bulleted-list"><li style="list-style-type:disc"><code>summary_ids[0]</code> ‚Äî –ø–µ—Ä–≤–∞—è (–∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è) –≥–∏–ø–æ—Ç–µ–∑–∞ –¥–ª—è –Ω–∞—à–µ–≥–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞.</li></ul><ul id="2ab568fa-e39f-805d-a208-d920c19362e5" class="bulleted-list"><li style="list-style-type:disc"><code>skip_special_tokens=True</code> ‚Äî —É–±–∏—Ä–∞–µ—Ç <code>&lt;s&gt;</code>, <code>&lt;/s&gt;</code>, <code>&lt;pad&gt;</code> –∏ —Ç.–ø.</li></ul><p id="2ab568fa-e39f-8080-ba45-d29b2bd342a0" class="">–ù–∞ —ç—Ç–æ–º –º–µ—Å—Ç–µ –ø–æ–ª–µ–∑–Ω–æ —Å —É—á–µ–Ω–∏–∫–∞–º–∏ –æ–±—Å—É–¥–∏—Ç—å:</p><p id="2ab568fa-e39f-80f6-a15e-c3818bf86f03" class="">–Ω–∞—Å–∫–æ–ª—å–∫–æ summary –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—ë—Ç —Å—É—Ç—å –¥–∏–∞–ª–æ–≥–∞, —á—Ç–æ –ø–æ—Ç–µ—Ä—è–ª–æ—Å—å, —á—Ç–æ –∏—Å–∫–∞–∂–µ–Ω–æ.</p><hr id="2ab568fa-e39f-8077-b72e-c54a6a0fb6b4"/><h2 id="2ab568fa-e39f-80ce-a75d-fb1070c167af" class="">4. –ü—Ä–∞–∫—Ç–∏–∫–∞, —á–∞—Å—Ç—å 2. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ä–µ–∂–∏–º—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: greedy, beam, sampling</h2><p id="2ab568fa-e39f-807b-862f-e0c9b4860de2" class="">–¢–µ–ø–µ—Ä—å –¥–∞—ë–º —É—á–µ–Ω–∏–∫–∞–º –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å, —á—Ç–æ <strong>–æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏</strong> –º–æ–≥—É—Ç –≤–µ—Å—Ç–∏ —Å–µ–±—è –æ—á–µ–Ω—å –ø–æ-—Ä–∞–∑–Ω–æ–º—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.</p><h3 id="2ab568fa-e39f-8091-b7e1-d6c109b66dc2" class="">4.1. –í–≤–æ–¥–∏–º —Ç—Ä–∏ —Ä–µ–∂–∏–º–∞</h3><p id="2ab568fa-e39f-80ef-b1e1-d801ff5c8620" class="">–°–¥–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç <code>dialog</code> –∏ <code>mode</code>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-80fd-9e7d-f63841475a10" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">def summarize(dialog: str, mode: str = &quot;beam&quot;) -&gt; str:
    inputs = tokenizer(
        dialog,
        return_tensors=&quot;pt&quot;,
        truncation=True,
        max_length=512,
    )

    if torch.cuda.is_available():
        inputs = {k: v.to(device) for k, v in inputs.items()}

    gen_kwargs = dict(
        max_new_tokens=60,
        min_length=20,
        no_repeat_ngram_size=3,
    )

    if mode == &quot;greedy&quot;:
        # –ñ–∞–¥–Ω—ã–π —Ä–µ–∂–∏–º: –≤—Å–µ–≥–¥–∞ –±–µ—Ä—ë–º —Å–∞–º—ã–π –≤–µ—Ä–æ—è—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω
        gen_kwargs.update(
            num_beams=1,
            do_sample=False,
        )
    elif mode == &quot;beam&quot;:
        # Beam search: –¥–µ—Ä–∂–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
        gen_kwargs.update(
            num_beams=4,
            do_sample=False,
        )
    elif mode == &quot;sample&quot;:
        # –°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º: —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
        gen_kwargs.update(
            do_sample=True,
            top_k=50,
            top_p=0.9,
            temperature=0.7,
        )
    else:
        raise ValueError(f&quot;Unknown mode: {mode}&quot;)

    with torch.no_grad():
        summary_ids = model.generate(
            **inputs,
            **gen_kwargs,
        )

    summary = tokenizer.decode(summary_ids[0], skip_special_tokens=True)
    return summary
</code></pre><p id="2ab568fa-e39f-80ce-9035-df9b15c15bb1" class="">–†–∞–∑–±–∏—Ä–∞–µ–º:</p><ul id="2ab568fa-e39f-80a8-baca-e2b33b1b153c" class="bulleted-list"><li style="list-style-type:disc"><code>mode == &quot;greedy&quot;</code>:<ul id="2ab568fa-e39f-80f5-a9ce-c5b2b750e1d2" class="bulleted-list"><li style="list-style-type:circle"><code>num_beams=1</code>, <code>do_sample=False</code>:<ul id="2ab568fa-e39f-80d7-9e0d-ef78ddc37150" class="bulleted-list"><li style="list-style-type:square">–≤—Å–µ–≥–¥–∞ –≤—ã–¥–∞—ë—Ç ‚Äú—Å–∞–º—ã–π –≤–µ—Ä–æ—è—Ç–Ω—ã–π‚Äù —Ç–æ–∫–µ–Ω,</li></ul><ul id="2ab568fa-e39f-809e-92b8-d389f21a1bb4" class="bulleted-list"><li style="list-style-type:square">—Ç–µ–∫—Å—Ç –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ-–æ–¥–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π.</li></ul></li></ul></li></ul><ul id="2ab568fa-e39f-808a-a03f-df9d966f0a44" class="bulleted-list"><li style="list-style-type:disc"><code>mode == &quot;beam&quot;</code>:<ul id="2ab568fa-e39f-8047-b195-cfc94d1046c5" class="bulleted-list"><li style="list-style-type:circle"><code>num_beams=4</code>:<ul id="2ab568fa-e39f-809d-98c7-f4639e96067f" class="bulleted-list"><li style="list-style-type:square">–∏—â–µ—Ç –±–æ–ª–µ–µ –≥–ª–æ–±–∞–ª—å–Ω–æ ‚Äú–ª—É—á—à–∏–π‚Äù –≤–∞—Ä–∏–∞–Ω—Ç,</li></ul><ul id="2ab568fa-e39f-805b-873e-cdbf96b7a5b6" class="bulleted-list"><li style="list-style-type:square">–±–æ–ª–µ–µ –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π, –Ω–æ –∏–Ω–æ–≥–¥–∞ —Å–ª–∏—à–∫–æ–º ‚Äú—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π‚Äù.</li></ul></li></ul></li></ul><ul id="2ab568fa-e39f-8065-a36a-d2d491898544" class="bulleted-list"><li style="list-style-type:disc"><code>mode == &quot;sample&quot;</code>:<ul id="2ab568fa-e39f-801d-827b-f2a7914e0513" class="bulleted-list"><li style="list-style-type:circle"><code>do_sample=True</code>, <code>top_k</code>, <code>top_p</code>, <code>temperature</code>:<ul id="2ab568fa-e39f-8017-a397-ea9a62810531" class="bulleted-list"><li style="list-style-type:square">–¥–æ–±–∞–≤–ª—è–µ–º —Ä–∞–Ω–¥–æ–º–∞,</li></ul><ul id="2ab568fa-e39f-80c8-977b-f3d124cc75bc" class="bulleted-list"><li style="list-style-type:square">—Ç–µ–∫—Å—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ –∂–∏–≤—ã–º, –Ω–æ –∏–Ω–æ–≥–¥–∞ –∏ —Å—Ç—Ä–∞–Ω–Ω—ã–º.</li></ul></li></ul></li></ul><h3 id="2ab568fa-e39f-8057-8b07-ce216ac66c68" class="">4.2. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –≤—ã–≤–æ–¥—ã —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8059-8e6c-dbebfd786319" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">for m in [&quot;greedy&quot;, &quot;beam&quot;, &quot;sample&quot;]:
    print(&quot;=&quot; * 80)
    print(f&quot;MODE: {m}&quot;)
    print(&quot;-&quot; * 80)
    print(summarize(dialog, mode=m))
    print()
</code></pre><p id="2ab568fa-e39f-80ff-8b2b-c4f029337534" class=""><strong>–ß—Ç–æ —Å—Ç–æ–∏—Ç –æ–±—Å—É–¥–∏—Ç—å —Å —É—á–µ–Ω–∏–∫–∞–º–∏:</strong></p><ul id="2ab568fa-e39f-80df-8d63-e68c42fbf134" class="bulleted-list"><li style="list-style-type:disc">–ì–¥–µ –º–æ–¥–µ–ª—å –¥–∞—ë—Ç <strong>—Å–ª–∏—à–∫–æ–º —Å—É—Ö–æ–µ</strong> summary?</li></ul><ul id="2ab568fa-e39f-803a-9984-c8999ffce00b" class="bulleted-list"><li style="list-style-type:disc">–ì–¥–µ summary <strong>—Å–ª–∏—à–∫–æ–º –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ–µ</strong> –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø—Ä–∏–¥—É–º—ã–≤–∞—Ç—å –ª–∏—à–Ω–µ–µ?</li></ul><ul id="2ab568fa-e39f-8090-a4bd-ca1b84e3ae71" class="bulleted-list"><li style="list-style-type:disc">–í–∏–¥–Ω–æ –ª–∏, —á—Ç–æ beam search:<ul id="2ab568fa-e39f-8028-a15e-e8ce80d6ea04" class="bulleted-list"><li style="list-style-type:circle">—á–∞—â–µ –¥–∞—ë—Ç –±–æ–ª–µ–µ –ª–æ–≥–∏—á–Ω—É—é, —Å–≤—è–∑–Ω—É—é —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫—É,</li></ul><ul id="2ab568fa-e39f-8095-9bbe-d55f24ca4d0b" class="bulleted-list"><li style="list-style-type:circle">–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å ‚Äú—Å–∫—É—á–Ω–µ–µ‚Äù?</li></ul></li></ul><ul id="2ab568fa-e39f-806d-b2bc-f79c53f21c66" class="bulleted-list"><li style="list-style-type:disc">–í–∏–¥–Ω–æ –ª–∏, —á—Ç–æ sampling:<ul id="2ab568fa-e39f-8062-83f1-f7fcc49f7b31" class="bulleted-list"><li style="list-style-type:circle">–º–µ—Å—Ç–∞–º–∏ —Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ—Ç –∏–Ω–∞—á–µ,</li></ul><ul id="2ab568fa-e39f-8095-b3fe-e7367d383ac0" class="bulleted-list"><li style="list-style-type:circle">–∏–Ω–æ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç –ª–∏—à–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ / ‚Äú—Ñ–∞–Ω—Ç–∞–∑–∏—Ä—É–µ—Ç‚Äù?</li></ul></li></ul><hr id="2ab568fa-e39f-800f-89a9-f150563fc1cd"/><h2 id="2ab568fa-e39f-8088-910f-d3da3834d5d7" class="">5. –ü—Ä–∞–∫—Ç–∏–∫–∞, —á–∞—Å—Ç—å 3. –ù–µ–±–æ–ª—å—à–æ–π —Ö–µ–ª–ø–µ—Ä –¥–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤</h2><p id="2ab568fa-e39f-8068-a234-c3a76d57b35a" class="">–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ (–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –º–æ–¥—É–ª–µ–π) –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –º–∏–Ω–∏-–æ–±—ë—Ä—Ç–∫—É:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-8001-be5f-c3e4f643aad0" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">def build_summarizer(
    model_id: str = &quot;facebook/bart-large-cnn&quot;,
    device: str | None = None,
):
    tokenizer = AutoTokenizer.from_pretrained(model_id)
    model = AutoModelForSeq2SeqLM.from_pretrained(model_id)

    if device is None:
        device = &quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;

    device = torch.device(device)
    model.to(device)

    def summarize(dialog: str, mode: str = &quot;beam&quot;) -&gt; str:
        inputs = tokenizer(
            dialog,
            return_tensors=&quot;pt&quot;,
            truncation=True,
            max_length=512,
        )
        inputs = {k: v.to(device) for k, v in inputs.items()}

        gen_kwargs = dict(
            max_new_tokens=60,
            min_length=20,
            no_repeat_ngram_size=3,
        )

        if mode == &quot;greedy&quot;:
            gen_kwargs.update(num_beams=1, do_sample=False)
        elif mode == &quot;beam&quot;:
            gen_kwargs.update(num_beams=4, do_sample=False)
        elif mode == &quot;sample&quot;:
            gen_kwargs.update(
                do_sample=True,
                top_k=50,
                top_p=0.9,
                temperature=0.7,
            )
        else:
            raise ValueError(f&quot;Unknown mode: {mode}&quot;)

        with torch.no_grad():
            ids = model.generate(**inputs, **gen_kwargs)

        return tokenizer.decode(ids[0], skip_special_tokens=True)

    return summarize
</code></pre><p id="2ab568fa-e39f-809e-b0ec-c8960f2586b7" class="">–ò –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ab568fa-e39f-806e-8e26-d740c9184347" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">summarize = build_summarizer()

print(summarize(dialog, mode=&quot;beam&quot;))
</code></pre><p id="2ab568fa-e39f-8055-8d18-c1bfb0239ea1" class="">–≠—Ç–æ –º–æ–∂–Ω–æ –ø–æ—Ç–æ–º –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏—Ö —É—Ä–æ–∫–∞—Ö (seq2seq-fine-tuning, –º–∏–Ω–∏-API –∏ —Ç.–ø.).</p><hr id="2ab568fa-e39f-8057-b461-ff187bbf255c"/><h2 id="2ab568fa-e39f-8084-8303-ee3dce121998" class="">6. –¢–∏–ø–∏—á–Ω—ã–µ –≥—Ä–∞–±–ª–∏ –∏ –≤–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–∏—Ç –ø—Ä–æ–≥–æ–≤–æ—Ä–∏—Ç—å</h2><p id="2ab568fa-e39f-80d8-96d8-d0fb9b76cab1" class="">–ß—Ç–æ–±—ã —É—á–µ–Ω–∏–∫–∏ –º–µ–Ω—å—à–µ —Å—Ç—Ä–∞–¥–∞–ª–∏:</p><ol type="1" id="2ab568fa-e39f-8098-8843-e479bd8b258e" class="numbered-list" start="1"><li><strong>–°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç</strong><ul id="2ab568fa-e39f-80ff-b021-e2ba7947ef15" class="bulleted-list"><li style="list-style-type:disc">–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞—Ç—å <code>truncation=True</code>, <code>max_length</code>, –º–æ–∂–Ω–æ —Å–ª–æ–≤–∏—Ç—å –æ—à–∏–±–∫—É;</li></ul><ul id="2ab568fa-e39f-80e7-9d01-c89d736762b9" class="bulleted-list"><li style="list-style-type:disc">–¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ –Ω–∞–¥–æ —Å–ª–µ–¥–∏—Ç—å –∑–∞ <code>model.config.max_position_embeddings</code>.</li></ul></li></ol><ol type="1" id="2ab568fa-e39f-8007-9b58-c80b73f4ae24" class="numbered-list" start="2"><li><strong>–°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π output</strong><ul id="2ab568fa-e39f-80a2-8b96-e8c114d0438c" class="bulleted-list"><li style="list-style-type:disc">–±–µ–∑ <code>max_new_tokens</code> –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ª–∑—Ç–∏ –¥–æ <code>max_length</code>, —á—Ç–æ –∏–Ω–æ–≥–¥–∞ –¥–æ–ª–≥–æ –∏ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ.</li></ul></li></ol><ol type="1" id="2ab568fa-e39f-804f-8c84-c061b01260c4" class="numbered-list" start="3"><li><strong>GPU vs CPU</strong><ul id="2ab568fa-e39f-802c-9bf3-e1aa5c5bb502" class="bulleted-list"><li style="list-style-type:disc">–Ω–∞ CPU –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ;</li></ul><ul id="2ab568fa-e39f-8094-8187-c23eab3e614b" class="bulleted-list"><li style="list-style-type:disc">–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å, –ø–µ—Ä–µ–Ω–æ—Å–∏–º –º–æ–¥–µ–ª—å –∏ inputs –Ω–∞ GPU:<p id="2ab568fa-e39f-80fc-8e15-e4f961b1d59b" class=""><code>model.to(&quot;cuda&quot;)</code>, <code>inputs = {k: v.to(&quot;cuda&quot;) for k, v in inputs.items()}</code>.</p></li></ul></li></ol><ol type="1" id="2ab568fa-e39f-8013-b978-c3b84d977a94" class="numbered-list" start="4"><li><strong>–î–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º</strong><ul id="2ab568fa-e39f-8054-9c8f-e90acc943ba1" class="bulleted-list"><li style="list-style-type:disc">greedy / beam search ‚Üí –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ (–ø—Ä–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ—Å–∞—Ö),</li></ul><ul id="2ab568fa-e39f-80a5-b7a2-d00f27ebd214" class="bulleted-list"><li style="list-style-type:disc">sampling ‚Üí –∫–∞–∂–¥—ã–π –∑–∞–ø—É—Å–∫ –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å —á—É—Ç—å –¥—Ä—É–≥–æ–π —Ç–µ–∫—Å—Ç.</li></ul></li></ol><ol type="1" id="2ab568fa-e39f-803e-b905-c7d8e7093dd0" class="numbered-list" start="5"><li><strong>–ü–æ–¥–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</strong><ul id="2ab568fa-e39f-8035-b972-c0796d0a8c72" class="bulleted-list"><li style="list-style-type:disc"><code>num_beams</code>: 1‚Äì8 –æ–±—ã—á–Ω–æ —Ö–≤–∞—Ç–∞–µ—Ç;</li></ul><ul id="2ab568fa-e39f-8096-b8d4-d3f359da1d0d" class="bulleted-list"><li style="list-style-type:disc"><code>top_k</code>, <code>top_p</code>, <code>temperature</code>:<ul id="2ab568fa-e39f-80f5-8d1b-ef45be036b0f" class="bulleted-list"><li style="list-style-type:circle">—á–µ–º –≤—ã—à–µ <code>temperature</code> ‚Üí —Ç–µ–º –±–æ–ª–µ–µ ‚Äú—Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–Ω–∞—è‚Äù –º–æ–¥–µ–ª—å,</li></ul><ul id="2ab568fa-e39f-8078-b191-f35244c2d7b5" class="bulleted-list"><li style="list-style-type:circle"><code>top_k</code>: –º–æ–¥–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–∫–µ–Ω –∏–∑ —Ç–æ–ø-k —Å–∞–º—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω—ã—Ö,</li></ul><ul id="2ab568fa-e39f-809e-95fd-fdfbc686ce8a" class="bulleted-list"><li style="list-style-type:circle"><code>top_p</code>: –º–æ–¥–µ–ª—å –±–µ—Ä—ë—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–æ–∫–µ–Ω–æ–≤, —Å—É–º–º–∞—Ä–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä—ã—Ö ‚â• <code>p</code>.</li></ul></li></ul></li></ol><hr id="2ab568fa-e39f-802b-93db-d0d2d7f1f38b"/><h2 id="2ab568fa-e39f-8025-96f6-f31898d89e89" class="">7. –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –∫ —É—Ä–æ–∫—É 5.1</h2><p id="2ab568fa-e39f-8055-8b4b-d7ccbe9e75e1" class="">–ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–∫:</p><ol type="1" id="2ab568fa-e39f-8069-91ec-ce9717631588" class="numbered-list" start="1"><li>–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å <strong>–º–∏–Ω–∏–º—É–º 3 —Ä–∞–∑–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–∞</strong>:<ul id="2ab568fa-e39f-8043-9e74-eb6324d284be" class="bulleted-list"><li style="list-style-type:disc">–∫–æ—Ä–æ—Ç–∫–∏–π (2‚Äì3 —Ä–µ–ø–ª–∏–∫–∏),</li></ul><ul id="2ab568fa-e39f-80ee-924e-c79c3bcc430e" class="bulleted-list"><li style="list-style-type:disc">—Å—Ä–µ–¥–Ω–∏–π (5‚Äì7 —Ä–µ–ø–ª–∏–∫),</li></ul><ul id="2ab568fa-e39f-8044-bdac-fe3382365977" class="bulleted-list"><li style="list-style-type:disc">–¥–ª–∏–Ω–Ω—ã–π (10+ —Ä–µ–ø–ª–∏–∫).</li></ul></li></ol><ol type="1" id="2ab568fa-e39f-80a3-81f9-c87bacf0b48f" class="numbered-list" start="2"><li>–î–ª—è –∫–∞–∂–¥–æ–≥–æ:<ul id="2ab568fa-e39f-807a-a86f-df600dd5c09a" class="bulleted-list"><li style="list-style-type:disc">—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å summary –≤ —Ç—Ä—ë—Ö —Ä–µ–∂–∏–º–∞—Ö: <code>&quot;greedy&quot;</code>, <code>&quot;beam&quot;</code>, <code>&quot;sample&quot;</code>;</li></ul><ul id="2ab568fa-e39f-80ca-812d-f777669d19a5" class="bulleted-list"><li style="list-style-type:disc">–∑–∞–ø–∏—Å–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–∞–±–ª–∏—á–∫—É/–Ω–æ—É—Ç–±—É–∫:<ul id="2ab568fa-e39f-808c-ab91-ef21c1b2177d" class="bulleted-list"><li style="list-style-type:circle">–¥–∏–∞–ª–æ–≥,</li></ul><ul id="2ab568fa-e39f-80f0-8781-e7ca77ef9c0b" class="bulleted-list"><li style="list-style-type:circle">—Ç—Ä–∏ summaries,</li></ul><ul id="2ab568fa-e39f-80df-be72-f4006d0253ad" class="bulleted-list"><li style="list-style-type:circle">–∫–æ—Ä–æ—Ç–∫–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: –∫–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –∫–∞–∂–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–º –∏ –ø–æ—á–µ–º—É.</li></ul></li></ul></li></ol><ol type="1" id="2ab568fa-e39f-80e5-be48-efd7ce1fe2b5" class="numbered-list" start="3"><li>–ü–æ–∏–≥—Ä–∞—Ç—å—Å—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:<ul id="2ab568fa-e39f-8051-baf4-ef79e0a4eef0" class="bulleted-list"><li style="list-style-type:disc"><code>num_beams</code> = 2, 4, 8;</li></ul><ul id="2ab568fa-e39f-80bb-b35d-ecf98c9d552f" class="bulleted-list"><li style="list-style-type:disc"><code>temperature</code> = 0.3, 0.7, 1.0;</li></ul><ul id="2ab568fa-e39f-80a1-889b-ea5e31cfd75b" class="bulleted-list"><li style="list-style-type:disc">—Å–¥–µ–ª–∞—Ç—å –ø–∞—Ä—É —Å–∫—Ä–∏–Ω–æ–≤/—Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç ‚Äú–∫–∞–∫ –º–µ–Ω—è—é—Ç—Å—è —Ç–µ–∫—Å—Ç—ã‚Äù.</li></ul></li></ol><hr id="2ab568fa-e39f-8098-a67f-d4e567fe5121"/><p id="2ab568fa-e39f-8046-8ad4-f3ed8a51ca5f" class="">–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –¥–∞–ª—å—à–µ –º–æ–≥—É —Ç–∞–∫ –∂–µ —Ä–∞–∑–ª–æ–∂–∏—Ç—å <strong>—É—Ä–æ–∫ 5.2</strong>:</p><p id="2ab568fa-e39f-80b1-a5bf-ebf1c82b94f3" class="">–ø–æ–ª–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ <code>dialog ‚Üí summary</code>, —Å <code>map</code>, <code>DataCollatorForSeq2Seq</code> –∏ –≤—Å–µ–º–∏ –ø–æ–¥–≤–æ–¥–Ω—ã–º–∏ –∫–∞–º–Ω—è–º–∏.</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>